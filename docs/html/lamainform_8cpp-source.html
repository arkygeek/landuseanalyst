<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Landuse Analyst: dev/cpp/landuseanalyst/src/gui/lamainform.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
<h1>dev/cpp/landuseanalyst/src/gui/lamainform.cpp</h1><a href="lamainform_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *   Copyright (C) 2007 by: Tim Sutton        tim@linfiniti.com            *</span>
<a name="l00003"></a>00003 <span class="comment"> *                          Jason Jorgenson   arkygeek@gmail.com           *</span>
<a name="l00004"></a>00004 <span class="comment"> *                                                                         *</span>
<a name="l00005"></a>00005 <span class="comment"> *   This program is free software; you can redistribute it and/or modify  *</span>
<a name="l00006"></a>00006 <span class="comment"> *   it under the terms of the GNU General Public License as published by  *</span>
<a name="l00007"></a>00007 <span class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</span>
<a name="l00008"></a>00008 <span class="comment"> *   (at your option) any later version.                                   *</span>
<a name="l00009"></a>00009 <span class="comment"> *                                                                         *</span>
<a name="l00010"></a>00010 <span class="comment"> *   This program is distributed in the hope that it will be useful,       *</span>
<a name="l00011"></a>00011 <span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of        *</span>
<a name="l00012"></a>00012 <span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *</span>
<a name="l00013"></a>00013 <span class="comment"> *   GNU General Public License for more details.                          *</span>
<a name="l00014"></a>00014 <span class="comment"> *                                                                         *</span>
<a name="l00015"></a>00015 <span class="comment"> *   You should have received a copy of the GNU General Public License     *</span>
<a name="l00016"></a>00016 <span class="comment"> *   along with this program; if not, write to the                         *</span>
<a name="l00017"></a>00017 <span class="comment"> *   Free Software Foundation, Inc.,                                       *</span>
<a name="l00018"></a>00018 <span class="comment"> *   59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.             *</span>
<a name="l00019"></a>00019 <span class="comment"> ***************************************************************************/</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021   <span class="comment">//app includes</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include "<a class="code" href="lamainform_8h.html">lamainform.h</a>"</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include "<a class="code" href="version_8h.html">version.h</a>"</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include "<a class="code" href="laanimalmanager_8h.html">laanimalmanager.h</a>"</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include "<a class="code" href="lacropmanager_8h.html">lacropmanager.h</a>"</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include "<a class="code" href="lacropparametermanager_8h.html">lacropparametermanager.h</a>"</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include "<a class="code" href="laanimalparametermanager_8h.html">laanimalparametermanager.h</a>"</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include "<a class="code" href="lamodel_8h.html">lamodel.h</a>"</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include "<a class="code" href="lamodelreports_8h.html">lamodelreports.h</a>"</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include "<a class="code" href="lagrass_8h.html">lagrass.h</a>"</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include "<a class="code" href="lagrassprocess_8h.html">lagrassprocess.h</a>"</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include "<a class="code" href="la_8h.html">la.h</a>"</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034   <span class="comment">//qt includes</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;QComboBox&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;QDir&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;QFile&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;QHeaderView&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;QListWidget&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;QProcess&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;QSettings&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;QStringList&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;QTableWidgetItem&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;QTextStream&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;QTreeWidget&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;QTreeWidgetItem&gt;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;QDebug&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;QPair&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;QString&gt;</span>
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="classLaMainForm.html#5fcf455c03090d2dc518b6b8bd8f07a2">00051</a> <a class="code" href="classLaMainForm.html#5fcf455c03090d2dc518b6b8bd8f07a2">LaMainForm::LaMainForm</a>(QWidget* parent, Qt::WFlags fl)
<a name="l00052"></a>00052   : QDialog(parent,fl)
<a name="l00053"></a>00053 {
<a name="l00054"></a>00054     <span class="comment">//required by Qt4 to initialise the ui</span>
<a name="l00055"></a>00055   setupUi(<span class="keyword">this</span>);
<a name="l00056"></a>00056   <a class="code" href="classLaMainForm.html#1041a61026a9fbb5549bbe538279a2e6">readSettings</a>();
<a name="l00057"></a>00057   lblCropPix-&gt;setScaledContents(<span class="keyword">true</span>);
<a name="l00058"></a>00058   lblAnimalPix-&gt;setScaledContents(<span class="keyword">true</span>);
<a name="l00059"></a>00059   lblCropPicCalcs-&gt;setScaledContents(<span class="keyword">true</span>);
<a name="l00060"></a>00060   lblAnimalPicCalcs-&gt;setScaledContents(<span class="keyword">true</span>);
<a name="l00061"></a>00061 
<a name="l00062"></a>00062   QStringList myWholeList;
<a name="l00063"></a>00063   <a class="code" href="classLaGrass.html">LaGrass</a> myGrass;
<a name="l00064"></a>00064   QStringList myMapsetList = myGrass.<a class="code" href="classLaGrass.html#333d63b771c598f5c5f571885dbae9f5">getMapsetList</a>();
<a name="l00065"></a>00065   cboMapSet-&gt;addItems(myMapsetList);
<a name="l00066"></a>00066   QStringListIterator myIterator(myMapsetList);
<a name="l00067"></a>00067   <span class="keywordflow">while</span> (myIterator.hasNext())
<a name="l00068"></a>00068   {
<a name="l00069"></a>00069       <span class="comment">//append the raster names in this mapet to our full list</span>
<a name="l00070"></a>00070     myWholeList &lt;&lt; myGrass.<a class="code" href="classLaGrass.html#0a978a93b568b6fc75053f92f1abb6c4">getRasterList</a>(myIterator.next());
<a name="l00071"></a>00071   }
<a name="l00072"></a>00072   QString myMapset = cboMapSet-&gt;currentText();
<a name="l00073"></a>00073   QStringList myList = myGrass.<a class="code" href="classLaGrass.html#0a978a93b568b6fc75053f92f1abb6c4">getRasterList</a>(myMapset);
<a name="l00074"></a>00074   cboDEM-&gt;addItems(myList);
<a name="l00075"></a>00075   cboCommonGrazingRaster-&gt;addItems(myList);
<a name="l00076"></a>00076   cboCommonCropRaster-&gt;addItems(myList);
<a name="l00077"></a>00077 
<a name="l00078"></a>00078     <span class="comment">//cboDEM-&gt;addItems(myGrass.getRasterList("</span>
<a name="l00079"></a>00079   lblVersion-&gt;setText(QString(<span class="stringliteral">"Version: %1"</span>).arg(<a class="code" href="version_8h.html#1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a>) + <span class="stringliteral">" "</span> + QString(<span class="stringliteral">"$Revision: 615 $"</span>).replace(<span class="stringliteral">"$"</span>,<span class="stringliteral">""</span>));
<a name="l00080"></a>00080   tblAnimals-&gt;horizontalHeader()-&gt;hide();
<a name="l00081"></a>00081   tblAnimals-&gt;verticalHeader()-&gt;hide();
<a name="l00082"></a>00082   tblAnimals-&gt;horizontalHeader()-&gt;setResizeMode(2,QHeaderView::Stretch);
<a name="l00083"></a>00083   tblCrops-&gt;horizontalHeader()-&gt;hide();
<a name="l00084"></a>00084   tblCrops-&gt;verticalHeader()-&gt;hide();
<a name="l00085"></a>00085   tblCrops-&gt;horizontalHeader()-&gt;setResizeMode(2,QHeaderView::Stretch);
<a name="l00086"></a>00086   listWidgetCalculationsAnimal-&gt;clear();
<a name="l00087"></a>00087   <a class="code" href="classLaMainForm.html#24c1d965173ef16dcae46a89f2e6c0e1">loadAnimals</a>();
<a name="l00088"></a>00088   <a class="code" href="classLaMainForm.html#e849f794758604dc070defcfb35bd42c">loadCrops</a>();
<a name="l00089"></a>00089   cbAreaUnits-&gt;addItem(<span class="stringliteral">"Dunum"</span>);
<a name="l00090"></a>00090   cbAreaUnits-&gt;addItem(<span class="stringliteral">"Hectare"</span>);
<a name="l00091"></a>00091   cbCommonLandEnergyType-&gt;addItem(<span class="stringliteral">"KCalories"</span>);
<a name="l00092"></a>00092   cbCommonLandEnergyType-&gt;addItem(<span class="stringliteral">"TDN"</span>);
<a name="l00093"></a>00093 
<a name="l00094"></a>00094   <a class="code" href="classLaMainForm.html#1abce250147e1e9412e5df728aabd88b">setDietLabels</a>();
<a name="l00102"></a>00102   connect(treeHelp, SIGNAL(currentItemChanged(QTreeWidgetItem * ,QTreeWidgetItem *)),
<a name="l00103"></a>00103       <span class="keyword">this</span>, SLOT(<a class="code" href="classLaMainForm.html#076c4ef3b09f55c995169bf1d6145347">helpItemClicked</a>(QTreeWidgetItem * ,QTreeWidgetItem *)));
<a name="l00104"></a>00104   connect(listWidgetCalculationsCrop, SIGNAL(currentItemChanged(QListWidgetItem * ,QListWidgetItem *)),
<a name="l00105"></a>00105       <span class="keyword">this</span>, SLOT(<a class="code" href="classLaMainForm.html#196c01db18626978fda5f27a26b77334">cropCalcClicked</a>(QListWidgetItem * ,QListWidgetItem *)));
<a name="l00106"></a>00106   connect(listWidgetCalculationsAnimal, SIGNAL(currentItemChanged(QListWidgetItem * ,QListWidgetItem *)),
<a name="l00107"></a>00107       <span class="keyword">this</span>, SLOT(<a class="code" href="classLaMainForm.html#76dc78137d056694ea36bde5652b7faf">animalCalcClicked</a>(QListWidgetItem * ,QListWidgetItem *)));
<a name="l00108"></a>00108   connect(pushButtonExit, SIGNAL(clicked()), qApp, SLOT(quit()));
<a name="l00109"></a>00109   connect(tblAnimals, SIGNAL(cellClicked( <span class="keywordtype">int</span>,<span class="keywordtype">int</span>)),
<a name="l00110"></a>00110       <span class="keyword">this</span>, SLOT(<a class="code" href="classLaMainForm.html#c9f7b04b7ccd3078ad6479f54fb64aa6">animalCellClicked</a>( <span class="keywordtype">int</span>,<span class="keywordtype">int</span>)));
<a name="l00111"></a>00111   connect(tblAnimals, SIGNAL(cellChanged( <span class="keywordtype">int</span>,<span class="keywordtype">int</span>)),
<a name="l00112"></a>00112       <span class="keyword">this</span>, SLOT(<a class="code" href="classLaMainForm.html#4a3596e1cd7c53a2000ba110c94b3aae">animalCellChanged</a>( <span class="keywordtype">int</span>,<span class="keywordtype">int</span>)));
<a name="l00113"></a>00113   connect(tblCrops, SIGNAL(cellClicked( <span class="keywordtype">int</span>,<span class="keywordtype">int</span>)),
<a name="l00114"></a>00114       <span class="keyword">this</span>, SLOT(<a class="code" href="classLaMainForm.html#c471b87b9dcd56d6d5180c74206bec73">cropCellClicked</a>( <span class="keywordtype">int</span>,<span class="keywordtype">int</span>)));
<a name="l00115"></a>00115   connect(tblCrops, SIGNAL(cellChanged( <span class="keywordtype">int</span>,<span class="keywordtype">int</span>)),
<a name="l00116"></a>00116       <span class="keyword">this</span>, SLOT(<a class="code" href="classLaMainForm.html#cc174496fa1b47dbd13440a2340a37bd">cropCellChanged</a>( <span class="keywordtype">int</span>,<span class="keywordtype">int</span>)));
<a name="l00117"></a>00117   connect(cbDebug, SIGNAL(clicked()),
<a name="l00118"></a>00118       <span class="keyword">this</span>, SLOT(<a class="code" href="classLaMainForm.html#8bd0679111b70886777d4c3edaab03c8">on_cbDebug_clicked</a>()));
<a name="l00119"></a>00119 }
<a name="l00120"></a>00120 
<a name="l00121"></a><a class="code" href="classLaMainForm.html#653cf89d8e5207e2cd43c6086d7c1210">00121</a> <a class="code" href="classLaMainForm.html#653cf89d8e5207e2cd43c6086d7c1210">LaMainForm::~LaMainForm</a>()
<a name="l00122"></a>00122 {
<a name="l00123"></a>00123   <a class="code" href="classLaMainForm.html#fa256126592a486ac3a4575e12fb18e7">writeSettings</a>();
<a name="l00124"></a>00124 }
<a name="l00125"></a>00125 
<a name="l00126"></a><a class="code" href="classLaMainForm.html#1041a61026a9fbb5549bbe538279a2e6">00126</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#1041a61026a9fbb5549bbe538279a2e6">LaMainForm::readSettings</a>()
<a name="l00127"></a>00127 {
<a name="l00128"></a>00128   QSettings mySettings;
<a name="l00129"></a>00129   QPoint pos = mySettings.value(<span class="stringliteral">"mainwindow/pos"</span>, QPoint(200, 200)).toPoint();
<a name="l00130"></a>00130   QSize size = mySettings.value(<span class="stringliteral">"mainwindow/size"</span>, QSize(400, 400)).toSize();
<a name="l00131"></a>00131   resize(size);
<a name="l00132"></a>00132   move(pos);
<a name="l00133"></a>00133 
<a name="l00134"></a>00134     <span class="comment">//</span>
<a name="l00135"></a>00135     <span class="comment">// Restore controls to their last used values</span>
<a name="l00136"></a>00136     <span class="comment">//</span>
<a name="l00137"></a>00137   lineEditSiteName-&gt;setText(mySettings.value(<span class="stringliteral">"siteName"</span>,<span class="stringliteral">""</span>).toString());
<a name="l00138"></a>00138   lineEditEasting-&gt;setText(mySettings.value(<span class="stringliteral">"easting"</span>,<span class="stringliteral">""</span>).toString());
<a name="l00139"></a>00139   lineEditNorthing-&gt;setText(mySettings.value(<span class="stringliteral">"northing"</span>,<span class="stringliteral">""</span>).toString());
<a name="l00140"></a>00140   sliderDiet-&gt;setValue(mySettings.value(<span class="stringliteral">"percentPlantDiet"</span>,<span class="stringliteral">"50"</span>).toInt());
<a name="l00141"></a>00141   sbCommonRasterValue-&gt;setValue(mySettings.value(<span class="stringliteral">"commonValue"</span>,<span class="stringliteral">"40"</span>).toInt());
<a name="l00142"></a>00142 }
<a name="l00143"></a>00143 
<a name="l00144"></a><a class="code" href="classLaMainForm.html#fa256126592a486ac3a4575e12fb18e7">00144</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#fa256126592a486ac3a4575e12fb18e7">LaMainForm::writeSettings</a>()
<a name="l00145"></a>00145 {
<a name="l00146"></a>00146   QSettings mySettings;
<a name="l00147"></a>00147   mySettings.setValue(<span class="stringliteral">"mainwindow/pos"</span>, pos());
<a name="l00148"></a>00148   mySettings.setValue(<span class="stringliteral">"mainwindow/size"</span>, size());
<a name="l00149"></a>00149 
<a name="l00150"></a>00150     <span class="comment">//</span>
<a name="l00151"></a>00151     <span class="comment">// Store defaults</span>
<a name="l00152"></a>00152     <span class="comment">//</span>
<a name="l00153"></a>00153   mySettings.setValue(<span class="stringliteral">"siteName"</span>,lineEditSiteName-&gt;text());
<a name="l00154"></a>00154   mySettings.setValue(<span class="stringliteral">"easting"</span>,lineEditEasting-&gt;text());
<a name="l00155"></a>00155   mySettings.setValue(<span class="stringliteral">"northing"</span>,lineEditNorthing-&gt;text());
<a name="l00156"></a>00156   mySettings.setValue(<span class="stringliteral">"percentPlantDiet"</span>,sliderDiet-&gt;value());
<a name="l00157"></a>00157   mySettings.setValue(<span class="stringliteral">"commonValue"</span>,sbCommonRasterValue-&gt;value());
<a name="l00158"></a>00158 }
<a name="l00159"></a>00159 
<a name="l00160"></a><a class="code" href="classLaMainForm.html#0238149cdee861950ab855c2683d0992">00160</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#0238149cdee861950ab855c2683d0992">LaMainForm::on_sbDailyCalories_valueChanged</a>(<span class="keywordtype">int</span> theValue)
<a name="l00161"></a>00161 {
<a name="l00162"></a>00162   <a class="code" href="classLaMainForm.html#1abce250147e1e9412e5df728aabd88b">setDietLabels</a>();
<a name="l00163"></a>00163 }
<a name="l00164"></a>00164 
<a name="l00165"></a><a class="code" href="classLaMainForm.html#c554c52d79b43004262fe3872845e098">00165</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#c554c52d79b43004262fe3872845e098">LaMainForm::on_cboxIncludeDairy_clicked</a>(<span class="keywordtype">bool</span> theBool)
<a name="l00166"></a>00166 {
<a name="l00167"></a>00167   <a class="code" href="classLaMainForm.html#1abce250147e1e9412e5df728aabd88b">setDietLabels</a>();
<a name="l00168"></a>00168 }
<a name="l00169"></a>00169 
<a name="l00170"></a><a class="code" href="classLaMainForm.html#175969b3125f675f40b1df98818968df">00170</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#175969b3125f675f40b1df98818968df">LaMainForm::on_cboxBaseOnPlants_clicked</a>(<span class="keywordtype">bool</span> theBool)
<a name="l00171"></a>00171 {
<a name="l00172"></a>00172   <a class="code" href="classLaMainForm.html#1abce250147e1e9412e5df728aabd88b">setDietLabels</a>();
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a><a class="code" href="classLaMainForm.html#6768f117aed177b7ecc281cc0b000271">00175</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#6768f117aed177b7ecc281cc0b000271">LaMainForm::on_cboxLimitDairy_clicked</a>(<span class="keywordtype">bool</span> theBool)
<a name="l00176"></a>00176 {
<a name="l00177"></a>00177   <a class="code" href="classLaMainForm.html#1abce250147e1e9412e5df728aabd88b">setDietLabels</a>();
<a name="l00178"></a>00178 }
<a name="l00179"></a>00179 
<a name="l00180"></a><a class="code" href="classLaMainForm.html#5c0a973a16d902fcc738322f21196113">00180</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#5c0a973a16d902fcc738322f21196113">LaMainForm::on_sliderMeat_valueChanged</a>(<span class="keywordtype">int</span> theValue)
<a name="l00181"></a>00181 {
<a name="l00182"></a>00182   QString myMinString = QString::number(100-theValue);
<a name="l00183"></a>00183   QString myMaxString = QString::number(theValue);
<a name="l00184"></a>00184   labelMeatWildPercent-&gt;setText(myMinString);
<a name="l00185"></a>00185   labelMeatTamePercent-&gt;setText(myMaxString);
<a name="l00186"></a>00186   <a class="code" href="classLaMainForm.html#1abce250147e1e9412e5df728aabd88b">setDietLabels</a>();
<a name="l00187"></a>00187 }
<a name="l00188"></a>00188 
<a name="l00189"></a><a class="code" href="classLaMainForm.html#1db95ba83b4383522bf756fa27496682">00189</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#1db95ba83b4383522bf756fa27496682">LaMainForm::on_sliderDiet_valueChanged</a>(<span class="keywordtype">int</span> theValue)
<a name="l00190"></a>00190 {
<a name="l00191"></a>00191   QString myMinString = QString::number(theValue);
<a name="l00192"></a>00192   QString myMaxString = QString::number(100-theValue);
<a name="l00193"></a>00193   labelMeatPercent-&gt;setText(myMinString);
<a name="l00194"></a>00194   labelCropPercent-&gt;setText(myMaxString);
<a name="l00195"></a>00195   <a class="code" href="classLaMainForm.html#1abce250147e1e9412e5df728aabd88b">setDietLabels</a>();
<a name="l00196"></a>00196 }
<a name="l00197"></a>00197 
<a name="l00198"></a><a class="code" href="classLaMainForm.html#baaf99215df4ca3e84d24d0276334d17">00198</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#baaf99215df4ca3e84d24d0276334d17">LaMainForm::on_sbDairyUtilisation_valueChanged</a>(<span class="keywordtype">int</span> theValue)
<a name="l00199"></a>00199 {
<a name="l00200"></a>00200   <a class="code" href="classLaMainForm.html#1abce250147e1e9412e5df728aabd88b">setDietLabels</a>();
<a name="l00201"></a>00201 }
<a name="l00202"></a>00202 
<a name="l00203"></a><a class="code" href="classLaMainForm.html#33f4c6b7d30a41ce0431759e3265cce0">00203</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#33f4c6b7d30a41ce0431759e3265cce0">LaMainForm::on_sliderCrop_valueChanged</a>(<span class="keywordtype">int</span> theValue)
<a name="l00204"></a>00204 {
<a name="l00205"></a>00205   QString myMinString = QString::number(100-theValue);
<a name="l00206"></a>00206   QString myMaxString = QString::number(theValue);
<a name="l00207"></a>00207   labelCropWildPercent-&gt;setText(myMinString);
<a name="l00208"></a>00208   labelCropTamePercent-&gt;setText(myMaxString);
<a name="l00209"></a>00209   <a class="code" href="classLaMainForm.html#1abce250147e1e9412e5df728aabd88b">setDietLabels</a>();
<a name="l00210"></a>00210 }
<a name="l00211"></a>00211 
<a name="l00218"></a><a class="code" href="classLaMainForm.html#679f6c82fc94e932039ba35617491e55">00218</a> <a class="code" href="la_8h.html#7fb71c75b479ea3a2bcd4909eb906865">LaTripleMap</a> <a class="code" href="classLaMainForm.html#679f6c82fc94e932039ba35617491e55">LaMainForm::getAvailableCrops</a>()
<a name="l00219"></a>00219 {
<a name="l00220"></a>00220   <span class="keywordflow">return</span> <a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>;
<a name="l00221"></a>00221 }
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="classLaMainForm.html#b55811e63a2d2c5fbf60c098ec51b4fb">00223</a> QString <a class="code" href="classLaMainForm.html#b55811e63a2d2c5fbf60c098ec51b4fb">LaMainForm::getMatchingCropParameterGuid</a>(QString theCropGuid)
<a name="l00224"></a>00224 {
<a name="l00225"></a>00225   QPair&lt;bool, QString&gt; myPair = <a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>.value(theCropGuid);
<a name="l00226"></a>00226   QString myCropParameterGuid = myPair.second;
<a name="l00227"></a>00227   <span class="keywordflow">return</span> myCropParameterGuid;
<a name="l00228"></a>00228 }
<a name="l00229"></a>00229 
<a name="l00230"></a><a class="code" href="classLaMainForm.html#76a13c01b32c67e9e0191f7bddbcfb9b">00230</a> QString <a class="code" href="classLaMainForm.html#76a13c01b32c67e9e0191f7bddbcfb9b">LaMainForm::getMatchingAnimalParameterGuid</a>(QString theAnimalGuid)
<a name="l00231"></a>00231 {
<a name="l00232"></a>00232   QPair&lt;bool, QString&gt; myPair = <a class="code" href="classLaMainForm.html#d6e0150e0845d22562f0c290babf94a8">mAnimalsMap</a>.value(theAnimalGuid);
<a name="l00233"></a>00233   QString myAnimalParameterGuid = myPair.second;
<a name="l00234"></a>00234   <span class="keywordflow">return</span> myAnimalParameterGuid;
<a name="l00235"></a>00235 }
<a name="l00236"></a>00236 
<a name="l00237"></a><a class="code" href="classLaMainForm.html#7b31f57f2a3ced5cece2f3221b1aae5f">00237</a> QPair &lt;int, int&gt; <a class="code" href="classLaMainForm.html#7b31f57f2a3ced5cece2f3221b1aae5f">LaMainForm::getSiteCoordinates</a>()
<a name="l00238"></a>00238 {
<a name="l00239"></a>00239   QPair &lt;int, int&gt; myCoordinates;
<a name="l00240"></a>00240   QString myNorthing = lineEditNorthing-&gt;text();
<a name="l00241"></a>00241   QString myEasting = lineEditEasting-&gt;text();
<a name="l00242"></a>00242 
<a name="l00243"></a>00243   myCoordinates.first = myEasting.toInt();
<a name="l00244"></a>00244   myCoordinates.second = myNorthing.toInt();
<a name="l00245"></a>00245 
<a name="l00246"></a>00246   <span class="keywordflow">return</span> myCoordinates;
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00249"></a><a class="code" href="classLaMainForm.html#b4d21ef731f8b07da0ddc7271508823b">00249</a> QString <a class="code" href="classLaMainForm.html#b4d21ef731f8b07da0ddc7271508823b">LaMainForm::getDEM</a>()
<a name="l00250"></a>00250 {
<a name="l00251"></a>00251   QString myDEM = cboDEM-&gt;currentText();
<a name="l00252"></a>00252   <span class="keywordflow">return</span> myDEM;
<a name="l00253"></a>00253 }
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 
<a name="l00256"></a><a class="code" href="classLaMainForm.html#8bbea485b47ad9feec8e6e82c5d85a55">00256</a> QMap &lt;QString, QString&gt; <a class="code" href="classLaMainForm.html#8bbea485b47ad9feec8e6e82c5d85a55">LaMainForm::getSelectedCrops</a>()
<a name="l00257"></a>00257 {
<a name="l00258"></a>00258     <span class="comment">//qDebug() &lt;&lt; "mCropsMap :::::: " &lt;&lt; mCropsMap;</span>
<a name="l00259"></a>00259 
<a name="l00260"></a>00260   QMap&lt;QString, QString&gt; mySelectedCropsMap;
<a name="l00261"></a>00261   QMapIterator&lt;QString, QPair&lt;bool, QString&gt; &gt; myCropIterator(<a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>);
<a name="l00262"></a>00262   <span class="keywordflow">while</span> (myCropIterator.hasNext())
<a name="l00263"></a>00263   {
<a name="l00264"></a>00264     myCropIterator.next();
<a name="l00265"></a>00265     QPair&lt;bool,QString&gt; myPair = myCropIterator.value();
<a name="l00266"></a>00266     QString myCropGuid = myCropIterator.key();
<a name="l00267"></a>00267     QString myCropParameterGuid = myPair.second;
<a name="l00268"></a>00268     <span class="keywordtype">bool</span> mySelectedFlag = myPair.first;
<a name="l00269"></a>00269     <span class="keywordflow">if</span> (mySelectedFlag)
<a name="l00270"></a>00270     {
<a name="l00271"></a>00271       mySelectedCropsMap.insert(myCropGuid,myCropParameterGuid);
<a name="l00272"></a>00272     }
<a name="l00273"></a>00273   }
<a name="l00274"></a>00274     <span class="keywordflow">return</span> mySelectedCropsMap;
<a name="l00275"></a>00275 }
<a name="l00276"></a>00276 
<a name="l00277"></a><a class="code" href="classLaMainForm.html#5fdedd256936634a8f802a9b59955b75">00277</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#5fdedd256936634a8f802a9b59955b75">LaMainForm::on_pbnNewAnimal_clicked</a>()
<a name="l00278"></a>00278 {
<a name="l00279"></a>00279   <a class="code" href="classLaAnimalManager.html">LaAnimalManager</a> myAnimalManager;
<a name="l00280"></a>00280   myAnimalManager.exec();
<a name="l00281"></a>00281   listWidgetCalculationsAnimal-&gt;clear();
<a name="l00282"></a>00282   <a class="code" href="classLaMainForm.html#24c1d965173ef16dcae46a89f2e6c0e1">loadAnimals</a>();
<a name="l00283"></a>00283 }
<a name="l00284"></a><a class="code" href="classLaMainForm.html#2fdf39e14706af34efdc3f7d1c19f949">00284</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#2fdf39e14706af34efdc3f7d1c19f949">LaMainForm::on_pbnNewCrop_clicked</a>()
<a name="l00285"></a>00285 {
<a name="l00286"></a>00286   <a class="code" href="classLaCropManager.html">LaCropManager</a> myCropManager;
<a name="l00287"></a>00287   myCropManager.exec();
<a name="l00288"></a>00288   <a class="code" href="classLaMainForm.html#e849f794758604dc070defcfb35bd42c">loadCrops</a>();
<a name="l00289"></a>00289 }
<a name="l00290"></a>00290 
<a name="l00291"></a><a class="code" href="classLaMainForm.html#1ead12c4b8085f1a82ca4a307447dcb2">00291</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#1ead12c4b8085f1a82ca4a307447dcb2">LaMainForm::on_pbnNewCropParameter_clicked</a>()
<a name="l00292"></a>00292 {
<a name="l00293"></a>00293     <a class="code" href="classLaCropParameterManager.html">LaCropParameterManager</a> myCropParameterManager;
<a name="l00294"></a>00294     myCropParameterManager.exec();
<a name="l00295"></a>00295     <a class="code" href="classLaMainForm.html#e849f794758604dc070defcfb35bd42c">loadCrops</a>();
<a name="l00296"></a>00296 }
<a name="l00297"></a>00297 
<a name="l00298"></a><a class="code" href="classLaMainForm.html#826be360fcac180a0a57441dd40ff11c">00298</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#826be360fcac180a0a57441dd40ff11c">LaMainForm::on_pbnNewAnimalParameter_clicked</a>()
<a name="l00299"></a>00299 {
<a name="l00300"></a>00300     <span class="keywordtype">int</span> myCommonGrazingLandValue = sbCommonRasterValue-&gt;value();
<a name="l00301"></a>00301     QString myComboBoxCommonLandEnergyType = cbCommonLandEnergyType-&gt;currentText();
<a name="l00302"></a>00302     QString myCommonGrazingLandAreaUnits = cbAreaUnits-&gt;currentText();
<a name="l00303"></a>00303     <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee47">AreaUnits</a> myAreaUnits = (myCommonGrazingLandAreaUnits == <span class="stringliteral">"Dunum"</span>) ? <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee4710d869fda8ef9b3852491ed49722a677">Dunum</a> : <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee476bf9786325e8633eb9e90667c85b339d">Hectare</a>;
<a name="l00304"></a>00304     <a class="code" href="la_8h.html#7a6534a55fc72bbcb547056b9eb694ed">EnergyType</a> myEnergyType = (myComboBoxCommonLandEnergyType == <span class="stringliteral">"KCalories"</span>) ? <a class="code" href="la_8h.html#7a6534a55fc72bbcb547056b9eb694edf01989f7865a5d3e380a68985117766a">KCalories</a> : <a class="code" href="la_8h.html#7a6534a55fc72bbcb547056b9eb694ed1756e3a2172131326e9b700da5cce029">TDN</a>;
<a name="l00305"></a>00305     QPair&lt;LaTripleMap, int&gt; myPair;
<a name="l00306"></a>00306     myPair.first=<a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>;
<a name="l00307"></a>00307     myPair.second=myCommonGrazingLandValue;
<a name="l00308"></a>00308     <a class="code" href="classLaAnimalParameterManager.html">LaAnimalParameterManager</a> myAnimalParameterManager(myPair, myAreaUnits, myEnergyType);
<a name="l00309"></a>00309     myAnimalParameterManager.exec();
<a name="l00310"></a>00310     listWidgetCalculationsAnimal-&gt;clear();
<a name="l00311"></a>00311     <a class="code" href="classLaMainForm.html#24c1d965173ef16dcae46a89f2e6c0e1">loadAnimals</a>();
<a name="l00312"></a>00312 }
<a name="l00313"></a>00313 
<a name="l00314"></a><a class="code" href="classLaMainForm.html#3899121315af44f928d8545b0b57cc24">00314</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#3899121315af44f928d8545b0b57cc24">LaMainForm::on_pbnFallow_clicked</a>()
<a name="l00315"></a>00315 {
<a name="l00316"></a>00316     <span class="comment">//not implemented</span>
<a name="l00317"></a>00317 }
<a name="l00318"></a>00318 
<a name="l00319"></a><a class="code" href="classLaMainForm.html#33206adc6bc86f3b9d1b5d5ab4c9e690">00319</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#33206adc6bc86f3b9d1b5d5ab4c9e690">LaMainForm::on_cboMapSet_currentIndexChanged</a>()
<a name="l00320"></a>00320 {
<a name="l00321"></a>00321   <a class="code" href="classLaGrass.html">LaGrass</a> myGrass;
<a name="l00322"></a>00322   QString myMapset = cboMapSet-&gt;currentText();
<a name="l00323"></a>00323   QStringList myList = myGrass.<a class="code" href="classLaGrass.html#0a978a93b568b6fc75053f92f1abb6c4">getRasterList</a>(myMapset);
<a name="l00324"></a>00324   cboDEM-&gt;clear();
<a name="l00325"></a>00325   cboCommonGrazingRaster-&gt;clear();
<a name="l00326"></a>00326   cboCommonCropRaster-&gt;clear();
<a name="l00327"></a>00327   cboDEM-&gt;addItems(myList);
<a name="l00328"></a>00328   cboCommonGrazingRaster-&gt;addItems(myList);
<a name="l00329"></a>00329   cboCommonCropRaster-&gt;addItems(myList);
<a name="l00330"></a>00330 }
<a name="l00331"></a>00331 
<a name="l00332"></a><a class="code" href="classLaMainForm.html#8bd0679111b70886777d4c3edaab03c8">00332</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#8bd0679111b70886777d4c3edaab03c8">LaMainForm::on_cbDebug_clicked</a>()
<a name="l00333"></a>00333 {
<a name="l00334"></a>00334   <span class="comment">/*if (cbDebug-&gt;checkState)</span>
<a name="l00335"></a>00335 <span class="comment">  {</span>
<a name="l00336"></a>00336 <span class="comment">    MainTabs.setTabEnabled(tabLogs);</span>
<a name="l00337"></a>00337 <span class="comment">  }</span>
<a name="l00338"></a>00338 <span class="comment">  else</span>
<a name="l00339"></a>00339 <span class="comment">  {</span>
<a name="l00340"></a>00340 <span class="comment">    tabLogs.setTabDisabled.setHidden</span>
<a name="l00341"></a>00341 <span class="comment">  }</span>
<a name="l00342"></a>00342 <span class="comment">    //(cbDebug-&gt;checkState) ? MainTabs.setTabEnabled(tabLogs) : tabLogs.setTabDisabled.setHidden;</span>
<a name="l00343"></a>00343 <span class="comment">  */</span>
<a name="l00344"></a>00344   <a class="code" href="classLaMainForm.html#acbb34fde5ae5de769a5f49cf49237fa">logMessage</a>(<span class="stringliteral">"This is supposed to hide/display the Logs Tab"</span>);
<a name="l00345"></a>00345 }
<a name="l00346"></a>00346 
<a name="l00347"></a><a class="code" href="classLaMainForm.html#24c1d965173ef16dcae46a89f2e6c0e1">00347</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#24c1d965173ef16dcae46a89f2e6c0e1">LaMainForm::loadAnimals</a>()
<a name="l00348"></a>00348 {
<a name="l00349"></a>00349   listWidgetCalculationsAnimal-&gt;clear();
<a name="l00350"></a>00350   <a class="code" href="classLaModel.html">LaModel</a> myModel;
<a name="l00351"></a>00351   myModel.<a class="code" href="classLaModel.html#450ec12501fb81a3b0992c70574d7513">clearCalcMaps</a>();
<a name="l00352"></a>00352   tblAnimals-&gt;clear();
<a name="l00353"></a>00353   tblAnimals-&gt;setRowCount(0);
<a name="l00354"></a>00354   tblAnimals-&gt;setColumnCount(4);
<a name="l00355"></a>00355       <span class="comment">// compute percentages each animal parameter adds to the total</span>
<a name="l00356"></a>00356   <span class="keywordtype">int</span> myCurrentRow=0;
<a name="l00357"></a>00357   <span class="keywordtype">float</span> myRunningPercentage=0.;
<a name="l00358"></a>00358   QMap&lt;QString,LaAnimal&gt; myAnimalsMap = <a class="code" href="classLaUtils.html#aa01841fb18f566d8c2668fe5de5fc44">LaUtils::getAvailableAnimals</a>();
<a name="l00359"></a>00359       <span class="comment">//debug statement to print all animal keys</span>
<a name="l00360"></a>00360       <span class="comment">//qDebug((static_cast&lt;QStringList&gt;(myAnimalsMap.keys())).join("\n").toLocal8Bit());</span>
<a name="l00361"></a>00361   <a class="code" href="classLaUtils.html#bb3eaf59e992919e8a872d05f0bf85ac">LaUtils::AnimalParameterMap</a> myAnimalParametersMap;
<a name="l00362"></a>00362   myAnimalParametersMap = <a class="code" href="classLaUtils.html#435911951413b858799a013a01b47586">LaUtils::getAvailableAnimalParameters</a>();
<a name="l00363"></a>00363   QMapIterator&lt;QString, LaAnimal&gt; myIterator(myAnimalsMap);
<a name="l00364"></a>00364   <span class="keywordflow">while</span> (myIterator.hasNext())
<a name="l00365"></a>00365   {
<a name="l00366"></a>00366     myIterator.next();
<a name="l00367"></a>00367     <a class="code" href="classLaAnimal.html">LaAnimal</a> myAnimal = myIterator.value();
<a name="l00368"></a>00368     QString myGuid = myAnimal.<a class="code" href="classLaGuid.html#38e7b78e2ef37526ffb1bad6af4cf745">guid</a>();
<a name="l00369"></a>00369     QString myName = myAnimal.<a class="code" href="classLaAnimal.html#e1ff383858093056914370f969a2304a">name</a>();
<a name="l00370"></a>00370     QPair&lt;bool,QString&gt; myValue;
<a name="l00371"></a>00371       <span class="comment">//check if this animal is in mAnimalsMap and if not add it</span>
<a name="l00372"></a>00372       <span class="comment">//with a blank pair for now</span>
<a name="l00373"></a>00373     <span class="keywordflow">if</span> (!<a class="code" href="classLaMainForm.html#d6e0150e0845d22562f0c290babf94a8">mAnimalsMap</a>.contains(myGuid))
<a name="l00374"></a>00374     {
<a name="l00375"></a>00375       myValue.first = <span class="keyword">false</span>;
<a name="l00376"></a>00376       myValue.second = <span class="stringliteral">""</span>;
<a name="l00377"></a>00377       <a class="code" href="classLaMainForm.html#d6e0150e0845d22562f0c290babf94a8">mAnimalsMap</a>.insert(myGuid,myValue);
<a name="l00378"></a>00378     }
<a name="l00379"></a>00379     <span class="keywordflow">else</span>
<a name="l00380"></a>00380     {
<a name="l00381"></a>00381       myValue=<a class="code" href="classLaMainForm.html#d6e0150e0845d22562f0c290babf94a8">mAnimalsMap</a>[myGuid];
<a name="l00382"></a>00382     }
<a name="l00383"></a>00383     QIcon myIcon;
<a name="l00384"></a>00384     myIcon.addFile(<span class="stringliteral">":/localdata.png"</span>);
<a name="l00385"></a>00385     tblAnimals-&gt;insertRow(myCurrentRow);
<a name="l00386"></a>00386       <span class="comment">// Add details to the new row</span>
<a name="l00387"></a>00387     QTableWidgetItem *mypUsedItem= <span class="keyword">new</span> QTableWidgetItem(tr(<span class="stringliteral">"Used?"</span>));
<a name="l00388"></a>00388       <span class="comment">//QTableWidgetItem *mypUsedItem= new QTableWidgetItem(tr(""));</span>
<a name="l00389"></a>00389     <span class="keywordflow">if</span> (myValue.first)
<a name="l00390"></a>00390     {
<a name="l00391"></a>00391       mypUsedItem-&gt;setCheckState(Qt::Checked);
<a name="l00392"></a>00392       QListWidgetItem *myItem = <span class="keyword">new</span> QListWidgetItem(myAnimal.<a class="code" href="classLaAnimal.html#e1ff383858093056914370f969a2304a">name</a>());
<a name="l00393"></a>00393       myItem-&gt;setData(Qt::UserRole,myAnimal.<a class="code" href="classLaGuid.html#38e7b78e2ef37526ffb1bad6af4cf745">guid</a>());
<a name="l00394"></a>00394       listWidgetCalculationsAnimal-&gt;addItem(myItem);
<a name="l00395"></a>00395     }
<a name="l00396"></a>00396     <span class="keywordflow">else</span>
<a name="l00397"></a>00397     {
<a name="l00398"></a>00398       mypUsedItem-&gt;setCheckState(Qt::Unchecked);
<a name="l00399"></a>00399         <span class="comment">// DE-populate the calcs QListWidgetItem</span>
<a name="l00400"></a>00400       QListWidgetItem *myItem = <span class="keyword">new</span> QListWidgetItem(myAnimal.<a class="code" href="classLaAnimal.html#e1ff383858093056914370f969a2304a">name</a>());
<a name="l00401"></a>00401       myItem-&gt;setData(Qt::UserRole,myAnimal.<a class="code" href="classLaGuid.html#38e7b78e2ef37526ffb1bad6af4cf745">guid</a>());
<a name="l00402"></a>00402       listWidgetCalculationsAnimal-&gt;takeItem(listWidgetCalculationsAnimal-&gt;row(myItem));
<a name="l00403"></a>00403     }
<a name="l00404"></a>00404     tblAnimals-&gt;setItem(myCurrentRow, 0, mypUsedItem);
<a name="l00405"></a>00405 
<a name="l00406"></a>00406     QTableWidgetItem *mypNameItem = <span class="keyword">new</span> QTableWidgetItem(myAnimal.<a class="code" href="classLaAnimal.html#e1ff383858093056914370f969a2304a">name</a>());
<a name="l00407"></a>00407     mypNameItem-&gt;setData(Qt::UserRole,myGuid);
<a name="l00408"></a>00408     tblAnimals-&gt;setItem(myCurrentRow, 1, mypNameItem);
<a name="l00409"></a>00409     mypNameItem-&gt;setIcon(myIcon);
<a name="l00410"></a>00410       <span class="comment">//create a var to hold the percentage for each selected parameter</span>
<a name="l00411"></a>00411       <span class="comment">//add the animal parameters combo to the form</span>
<a name="l00412"></a>00412     QComboBox * mypCombo = <span class="keyword">new</span> QComboBox(<span class="keyword">this</span>);
<a name="l00413"></a>00413     QMapIterator&lt;QString, LaAnimalParameter&gt; myIterator(myAnimalParametersMap);
<a name="l00414"></a>00414     <span class="keywordflow">while</span> (myIterator.hasNext())
<a name="l00415"></a>00415     {
<a name="l00416"></a>00416       myIterator.next();
<a name="l00417"></a>00417       <a class="code" href="classLaAnimalParameter.html">LaAnimalParameter</a> myAnimalParameter = myIterator.value();
<a name="l00418"></a>00418       QString myParameterGuid = myAnimalParameter.<a class="code" href="classLaGuid.html#38e7b78e2ef37526ffb1bad6af4cf745">guid</a>();
<a name="l00419"></a>00419       QString myParameterName = myAnimalParameter.<a class="code" href="classLaAnimalParameter.html#804809c4c95b5964b705a962909ce613">name</a>() + <span class="stringliteral">"  ("</span> + myAnimalParameter.<a class="code" href="classLaAnimalParameter.html#0ecd8de885a804229ae6b9c1b3307b4f">description</a>() + <span class="stringliteral">")"</span>;
<a name="l00420"></a>00420         <span class="comment">//only add this entry if it is for the current animal</span>
<a name="l00421"></a>00421       <span class="keywordflow">if</span> (myGuid != myAnimalParameter.<a class="code" href="classLaAnimalParameter.html#f93afb503c0851655e7caf842df6176c">animalGuid</a>())
<a name="l00422"></a>00422       {
<a name="l00423"></a>00423         <span class="keywordflow">continue</span>;
<a name="l00424"></a>00424       }
<a name="l00425"></a>00425         <span class="comment">//if the animal paraameter id has not yet been set in mAnimalsMap</span>
<a name="l00426"></a>00426         <span class="comment">//set it now...</span>
<a name="l00427"></a>00427       <span class="keywordflow">if</span> (myValue.second.isEmpty())
<a name="l00428"></a>00428       {
<a name="l00429"></a>00429         myValue.second = myParameterGuid;
<a name="l00430"></a>00430       }
<a name="l00431"></a>00431         <span class="comment">//see if this animal parameter percentage can be added to our running tot</span>
<a name="l00432"></a>00432       <span class="keywordflow">if</span> (myValue.second == myAnimalParameter.<a class="code" href="classLaGuid.html#38e7b78e2ef37526ffb1bad6af4cf745">guid</a>())
<a name="l00433"></a>00433       {
<a name="l00434"></a>00434         <span class="keywordflow">if</span> (myValue.first)
<a name="l00435"></a>00435           {
<a name="l00436"></a>00436             myRunningPercentage += myAnimalParameter.<a class="code" href="classLaAnimalParameter.html#7686aa9ee4ae4f34f5142eaa09e2b3ca">percentTameMeat</a>();
<a name="l00437"></a>00437           }
<a name="l00438"></a>00438         QTableWidgetItem *mypPercentItem =
<a name="l00439"></a>00439           <span class="keyword">new</span> QTableWidgetItem(QString::number(myAnimalParameter.<a class="code" href="classLaAnimalParameter.html#7686aa9ee4ae4f34f5142eaa09e2b3ca">percentTameMeat</a>()));
<a name="l00440"></a>00440         tblAnimals-&gt;setItem(myCurrentRow, 3, mypPercentItem);
<a name="l00441"></a>00441       }
<a name="l00442"></a>00442         <span class="comment">//                icon,  disp name,      userdata</span>
<a name="l00443"></a>00443       mypCombo-&gt;addItem(myIcon,myParameterName,myParameterGuid);
<a name="l00444"></a>00444     }
<a name="l00445"></a>00445     <a class="code" href="classLaMainForm.html#545a7512bc9d14f4ebee101c93c2272c">setComboToDefault</a>(mypCombo, myValue.second);
<a name="l00446"></a>00446     <a class="code" href="classLaMainForm.html#d6e0150e0845d22562f0c290babf94a8">mAnimalsMap</a>[myGuid]=myValue;
<a name="l00447"></a>00447     tblAnimals-&gt;setCellWidget ( myCurrentRow, 2, mypCombo);
<a name="l00448"></a>00448     myCurrentRow++;
<a name="l00449"></a>00449   }
<a name="l00450"></a>00450     <span class="comment">//finally show the total percentage all the selected animals contribute to the diet</span>
<a name="l00451"></a>00451   QIcon myIcon;
<a name="l00452"></a>00452   <span class="keywordflow">if</span> (myRunningPercentage==100)
<a name="l00453"></a>00453   {
<a name="l00454"></a>00454     myIcon.addFile(<span class="stringliteral">":/status_ok.png"</span>);
<a name="l00455"></a>00455   }
<a name="l00456"></a>00456   <span class="keywordflow">else</span>
<a name="l00457"></a>00457   {
<a name="l00458"></a>00458     myIcon.addFile(<span class="stringliteral">":/status_error.png"</span>);
<a name="l00459"></a>00459   }
<a name="l00460"></a>00460   QString myPercentItem = QString::number(myRunningPercentage);
<a name="l00461"></a>00461   labelAnimalCheck-&gt;setText(myPercentItem + <span class="stringliteral">"\%"</span>);
<a name="l00462"></a>00462     <span class="comment">//QLabel::setPixmap(labelAnimalCheck-&gt;(myIcon));</span>
<a name="l00463"></a>00463     <span class="comment">//tblAnimals-&gt;insertRow(myCurrentRow);</span>
<a name="l00464"></a>00464     <span class="comment">//QTableWidgetItem *mypLabelItem = new QTableWidgetItem(QString(tr("Total Diet %")));</span>
<a name="l00465"></a>00465     <span class="comment">//tblAnimals-&gt;setItem(myCurrentRow, 1, mypLabelItem);</span>
<a name="l00466"></a>00466     <span class="comment">//QTableWidgetItem *mypPercentItem =</span>
<a name="l00467"></a>00467     <span class="comment">//        new QTableWidgetItem(QString::number(myRunningPercentage));</span>
<a name="l00468"></a>00468     <span class="comment">//mypPercentItem-&gt;setIcon(myIcon);</span>
<a name="l00469"></a>00469     <span class="comment">//tblAnimals-&gt;setItem(myCurrentRow, 3, mypPercentItem);</span>
<a name="l00470"></a>00470 }
<a name="l00471"></a>00471 
<a name="l00472"></a>00472 <span class="comment">/*void LaMainForm::setModel(QMap&lt;QString,QString&gt; theSelectedAnimalsMap, QMap&lt;QString,QString&gt; theSelectedCropsMap)</span>
<a name="l00473"></a>00473 <span class="comment">{</span>
<a name="l00474"></a>00474 <span class="comment">  myModel.setCrops(theSelectedCropsMap);</span>
<a name="l00475"></a>00475 <span class="comment">  myModel.setAnimals(theSelectedAnimalsMap);</span>
<a name="l00476"></a>00476 <span class="comment">  QString mySelectedAreaUnit = QString(cbAreaUnits-&gt;currentText());</span>
<a name="l00477"></a>00477 <span class="comment">  myModel.setName(lineEditSiteName-&gt;text());</span>
<a name="l00478"></a>00478 <span class="comment">  myModel.setPopulation(sbPopulation-&gt;value());</span>
<a name="l00479"></a>00479 <span class="comment">  myModel.setPeriod(lineEditPeriod-&gt;text());</span>
<a name="l00480"></a>00480 <span class="comment">  myModel.setEasting(lineEditEasting-&gt;text().toInt());</span>
<a name="l00481"></a>00481 <span class="comment">  myModel.setNorthing(lineEditNorthing-&gt;text().toInt());</span>
<a name="l00482"></a>00482 <span class="comment">  myModel.setEuclideanDistance(radioButtonEuclidean-&gt;isChecked());</span>
<a name="l00483"></a>00483 <span class="comment">  myModel.setWalkingTime(radioButtonWalkingTime-&gt;isChecked());</span>
<a name="l00484"></a>00484 <span class="comment">  myModel.setPathDistance(radioButtonPathDistance-&gt;isChecked());</span>
<a name="l00485"></a>00485 <span class="comment">  myModel.setPrecision(sbModelPrecision-&gt;value());</span>
<a name="l00486"></a>00486 <span class="comment">  myModel.setDietPercent(sliderDiet-&gt;value());</span>
<a name="l00487"></a>00487 <span class="comment">  myModel.setCropPercent(sliderCrop-&gt;value());</span>
<a name="l00488"></a>00488 <span class="comment">  myModel.setMeatPercent(sliderMeat-&gt;value());</span>
<a name="l00489"></a>00489 <span class="comment">  myModel.setCaloriesPerPersonDaily(sbDailyCalories-&gt;value());</span>
<a name="l00490"></a>00490 <span class="comment">  QString myAreaUnitsText = (cbAreaUnits-&gt;currentText());</span>
<a name="l00491"></a>00491 <span class="comment">  myModel.setCommonLandAreaUnits(myAreaUnits);</span>
<a name="l00492"></a>00492 <span class="comment">  myModel.setBaseOnPlants(cboxBaseOnPlants-&gt;isChecked());</span>
<a name="l00493"></a>00493 <span class="comment">  myModel.setIncludeDairy(cboxIncludeDairy-&gt;isChecked());</span>
<a name="l00494"></a>00494 <span class="comment">  myModel.setLimitDairy(cboxIncludeDairy-&gt;isChecked());</span>
<a name="l00495"></a>00495 <span class="comment">  myModel.setLimitDairyPercent(sbLimitDairyPercent-&gt;value());</span>
<a name="l00496"></a>00496 <span class="comment">  myModel.setDairyUtilisation(sbDairyUtilisation-&gt;value());</span>
<a name="l00497"></a>00497 <span class="comment">  myModel.setCommonLandValue(sbCommonRasterValue-&gt;value(), myAreaUnits);</span>
<a name="l00498"></a>00498 <span class="comment">  myModel.DoCalculations();</span>
<a name="l00499"></a>00499 <span class="comment">}*/</span>
<a name="l00500"></a>00500 
<a name="l00501"></a><a class="code" href="classLaMainForm.html#e849f794758604dc070defcfb35bd42c">00501</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#e849f794758604dc070defcfb35bd42c">LaMainForm::loadCrops</a>()
<a name="l00502"></a>00502 {
<a name="l00503"></a>00503   listWidgetCalculationsCrop-&gt;clear();
<a name="l00504"></a>00504   tblCrops-&gt;clear();
<a name="l00505"></a>00505   tblCrops-&gt;setRowCount(0);
<a name="l00506"></a>00506   tblCrops-&gt;setColumnCount(4);
<a name="l00507"></a>00507     <span class="comment">//compute percentages each crop parameter adds to the total and</span>
<a name="l00508"></a>00508     <span class="comment">//print the total perc. Its up to the user at this stage to ensure</span>
<a name="l00509"></a>00509     <span class="comment">//that everything tots up to 100%</span>
<a name="l00510"></a>00510   <span class="keywordtype">int</span> myCurrentRow=0;
<a name="l00511"></a>00511   <span class="keywordtype">float</span> myRunningPercentage=0.;
<a name="l00512"></a>00512   QMap&lt;QString,LaCrop&gt; myCropsMap;
<a name="l00513"></a>00513   myCropsMap = <a class="code" href="classLaUtils.html#11f60f81b93a26a0c14d5812a68e6b16">LaUtils::getAvailableCrops</a>();
<a name="l00514"></a>00514     <span class="comment">//debug statemetn to print all crop keys</span>
<a name="l00515"></a>00515     <span class="comment">//qDebug((static_cast&lt;QStringList&gt;(myCropsMap.keys())).join("\n").toLocal8Bit());</span>
<a name="l00516"></a>00516   <a class="code" href="classLaUtils.html#9ac69a8e1a61029ce5cfbd5985930ec0">LaUtils::CropParameterMap</a> myCropParametersMap;
<a name="l00517"></a>00517   myCropParametersMap = <a class="code" href="classLaUtils.html#d50cf3269efc4c7298768ce78b56c610">LaUtils::getAvailableCropParameters</a>();
<a name="l00518"></a>00518   QMapIterator&lt;QString, LaCrop&gt; myIterator(myCropsMap);
<a name="l00519"></a>00519   <span class="keywordflow">while</span> (myIterator.hasNext())
<a name="l00520"></a>00520   {
<a name="l00521"></a>00521     myIterator.next();
<a name="l00522"></a>00522     <a class="code" href="classLaCrop.html">LaCrop</a> myCrop = myIterator.value();
<a name="l00523"></a>00523     QString myGuid = myCrop.<a class="code" href="classLaGuid.html#38e7b78e2ef37526ffb1bad6af4cf745">guid</a>();
<a name="l00524"></a>00524     QString myName = myCrop.<a class="code" href="classLaCrop.html#e2c84ed6c0c693b3edc22e0de658c275">name</a>();
<a name="l00525"></a>00525     QPair&lt;bool,QString&gt; myValue;
<a name="l00526"></a>00526       <span class="comment">//check if this crop is in mCropsMap and if not add it</span>
<a name="l00527"></a>00527       <span class="comment">//with a blank pair for now</span>
<a name="l00528"></a>00528     <span class="keywordflow">if</span> (!<a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>.contains(myGuid))
<a name="l00529"></a>00529     {
<a name="l00530"></a>00530       myValue.first = <span class="keyword">false</span>;
<a name="l00531"></a>00531       myValue.second = <span class="stringliteral">""</span>;
<a name="l00532"></a>00532       <a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>.insert(myGuid,myValue);
<a name="l00533"></a>00533         <span class="comment">//qDebug("Added new blank pair to mCrops map for keeping track of percentages: " +</span>
<a name="l00534"></a>00534         <span class="comment">//    myGuid.toLocal8Bit());</span>
<a name="l00535"></a>00535     }
<a name="l00536"></a>00536     <span class="keywordflow">else</span>
<a name="l00537"></a>00537     {
<a name="l00538"></a>00538       myValue=<a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>[myGuid];
<a name="l00539"></a>00539     }
<a name="l00540"></a>00540 
<a name="l00541"></a>00541     QIcon myIcon;
<a name="l00542"></a>00542     myIcon.addFile(<span class="stringliteral">":/localdata.png"</span>);
<a name="l00543"></a>00543     tblCrops-&gt;insertRow(myCurrentRow);
<a name="l00544"></a>00544       <span class="comment">// Add details to the new row</span>
<a name="l00545"></a>00545     QTableWidgetItem *mypUsedItem= <span class="keyword">new</span> QTableWidgetItem(tr(<span class="stringliteral">"Used?"</span>));
<a name="l00546"></a>00546     (myValue.first) ? mypUsedItem-&gt;setCheckState(Qt::Checked) : mypUsedItem-&gt;setCheckState(Qt::Unchecked);
<a name="l00547"></a>00547 
<a name="l00548"></a>00548     tblCrops-&gt;setItem(myCurrentRow, 0, mypUsedItem);
<a name="l00549"></a>00549     QTableWidgetItem *mypNameItem = <span class="keyword">new</span> QTableWidgetItem(myCrop.<a class="code" href="classLaCrop.html#e2c84ed6c0c693b3edc22e0de658c275">name</a>());
<a name="l00550"></a>00550     mypNameItem-&gt;setData(Qt::UserRole,myGuid);
<a name="l00551"></a>00551     tblCrops-&gt;setItem(myCurrentRow, 1, mypNameItem);
<a name="l00552"></a>00552     mypNameItem-&gt;setIcon(myIcon);
<a name="l00553"></a>00553       <span class="comment">//create a var to hold the percentage for each selected parameter</span>
<a name="l00554"></a>00554       <span class="comment">//add the crop parameters combo to the form</span>
<a name="l00555"></a>00555     QComboBox * mypCombo = <span class="keyword">new</span> QComboBox(<span class="keyword">this</span>);
<a name="l00556"></a>00556     QMapIterator&lt;QString, LaCropParameter&gt; myIterator(myCropParametersMap);
<a name="l00557"></a>00557     <span class="keywordflow">while</span> (myIterator.hasNext())
<a name="l00558"></a>00558     {
<a name="l00559"></a>00559       myIterator.next();
<a name="l00560"></a>00560       <a class="code" href="classLaCropParameter.html">LaCropParameter</a> myCropParameter = myIterator.value();
<a name="l00561"></a>00561       QString myParameterGuid = myCropParameter.<a class="code" href="classLaGuid.html#38e7b78e2ef37526ffb1bad6af4cf745">guid</a>();
<a name="l00562"></a>00562       QString myParameterName = myCropParameter.<a class="code" href="classLaCropParameter.html#5d878c97131022b992c21233c666bb77">name</a>()  + <span class="stringliteral">"  ("</span> + myCropParameter.<a class="code" href="classLaCropParameter.html#352d07db810789022c747cea40906e26">description</a>() + <span class="stringliteral">")"</span>;
<a name="l00563"></a>00563         <span class="comment">//only add this entry if it is for the current crop</span>
<a name="l00564"></a>00564       <span class="keywordflow">if</span> (myGuid != myCropParameter.<a class="code" href="classLaCropParameter.html#d26ff1e490ab1e357d01096f4ecb3def">cropGuid</a>())
<a name="l00565"></a>00565       {
<a name="l00566"></a>00566         <span class="keywordflow">continue</span>;
<a name="l00567"></a>00567       }
<a name="l00568"></a>00568         <span class="comment">//if the crop paraameter id has not yet been set in mCropsMap</span>
<a name="l00569"></a>00569         <span class="comment">//set it now...</span>
<a name="l00570"></a>00570       <span class="keywordflow">if</span> (myValue.second.isEmpty())
<a name="l00571"></a>00571       {
<a name="l00572"></a>00572         myValue.second = myParameterGuid;
<a name="l00573"></a>00573       }
<a name="l00574"></a>00574         <span class="comment">//see if this crop parameter percentage can be added to our running tot</span>
<a name="l00575"></a>00575         <span class="comment">//qDebug("Comparing " + myValue.second.toLocal8Bit() + " &lt;-&gt; " +</span>
<a name="l00576"></a>00576             <span class="comment">//myCropParameter.guid().toLocal8Bit());</span>
<a name="l00577"></a>00577       <span class="keywordflow">if</span> (myValue.second == myCropParameter.<a class="code" href="classLaGuid.html#38e7b78e2ef37526ffb1bad6af4cf745">guid</a>())
<a name="l00578"></a>00578       {
<a name="l00579"></a>00579         <span class="keywordflow">if</span> (myValue.first)
<a name="l00580"></a>00580           {
<a name="l00581"></a>00581             myRunningPercentage += myCropParameter.<a class="code" href="classLaCropParameter.html#431530fc1021ce00db44ee1c6a1dc8bd">percentTameCrop</a>();
<a name="l00582"></a>00582             QListWidgetItem *myItem = <span class="keyword">new</span> QListWidgetItem(myCrop.<a class="code" href="classLaCrop.html#e2c84ed6c0c693b3edc22e0de658c275">name</a>());
<a name="l00583"></a>00583             myItem-&gt;setData(Qt::UserRole,myCrop.<a class="code" href="classLaGuid.html#38e7b78e2ef37526ffb1bad6af4cf745">guid</a>());
<a name="l00584"></a>00584             listWidgetCalculationsCrop-&gt;addItem(myItem);
<a name="l00585"></a>00585           }
<a name="l00586"></a>00586         QTableWidgetItem *mypPercentItem =
<a name="l00587"></a>00587           <span class="keyword">new</span> QTableWidgetItem(QString::number(myCropParameter.<a class="code" href="classLaCropParameter.html#431530fc1021ce00db44ee1c6a1dc8bd">percentTameCrop</a>()));
<a name="l00588"></a>00588           <span class="comment">//qDebug("Percentage this crop contributes to diet: " +</span>
<a name="l00589"></a>00589               <span class="comment">//QString::number(myCropParameter.percentTameCrop()).toLocal8Bit());</span>
<a name="l00590"></a>00590         tblCrops-&gt;setItem(myCurrentRow, 3, mypPercentItem);
<a name="l00591"></a>00591       }
<a name="l00592"></a>00592         <span class="comment">//                icon, disp name, userdata</span>
<a name="l00593"></a>00593       mypCombo-&gt;addItem(myIcon,myParameterName,myParameterGuid);
<a name="l00594"></a>00594     }
<a name="l00595"></a>00595     <a class="code" href="classLaMainForm.html#545a7512bc9d14f4ebee101c93c2272c">setComboToDefault</a>(mypCombo, myValue.second);
<a name="l00596"></a>00596     <a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>[myGuid]=myValue;
<a name="l00597"></a>00597     tblCrops-&gt;setCellWidget ( myCurrentRow, 2, mypCombo);
<a name="l00598"></a>00598     myCurrentRow++;
<a name="l00599"></a>00599   }
<a name="l00600"></a>00600     <span class="comment">//finally show the total percentage all the selected crops contribute to the diet</span>
<a name="l00601"></a>00601   QIcon myIcon;
<a name="l00602"></a>00602   (myRunningPercentage==100) ? myIcon.addFile(<span class="stringliteral">":/status_ok.png"</span>) : myIcon.addFile(<span class="stringliteral">":/status_error.png"</span>);
<a name="l00603"></a>00603 
<a name="l00604"></a>00604   QString myPercentItem = QString::number(myRunningPercentage);
<a name="l00605"></a>00605   labelCropCheck-&gt;setText(myPercentItem + <span class="stringliteral">"\%"</span>);
<a name="l00606"></a>00606 }
<a name="l00607"></a>00607 
<a name="l00608"></a>00608 
<a name="l00609"></a>00609 
<a name="l00610"></a>00610 
<a name="l00611"></a>00611 
<a name="l00612"></a>00612 
<a name="l00613"></a>00613 
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 
<a name="l00616"></a>00616 
<a name="l00617"></a>00617 
<a name="l00618"></a>00618 
<a name="l00619"></a>00619 
<a name="l00620"></a>00620 
<a name="l00621"></a>00621 
<a name="l00622"></a>00622 
<a name="l00623"></a>00623 
<a name="l00624"></a>00624 
<a name="l00625"></a>00625 
<a name="l00626"></a>00626 
<a name="l00627"></a>00627 
<a name="l00628"></a>00628 
<a name="l00629"></a>00629 
<a name="l00630"></a>00630 
<a name="l00631"></a>00631 
<a name="l00632"></a>00632 
<a name="l00633"></a>00633 
<a name="l00634"></a><a class="code" href="classLaMainForm.html#1abce250147e1e9412e5df728aabd88b">00634</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#1abce250147e1e9412e5df728aabd88b">LaMainForm::setDietLabels</a>()
<a name="l00635"></a>00635 {
<a name="l00636"></a>00636   <span class="keywordtype">float</span> myDietPercentMeat = sliderDiet-&gt;value()*.01;
<a name="l00637"></a>00637   <span class="comment">//float myDietPercentPlant = (100.-(sliderDiet-&gt;value()))*.01;</span>
<a name="l00638"></a>00638   <span class="keywordtype">float</span> myTameMeatPercentage = sliderMeat-&gt;value()*.01;
<a name="l00639"></a>00639   <span class="keywordtype">float</span> myWildMeatPercentage = (100. -(sliderMeat-&gt;value()))*.01;
<a name="l00640"></a>00640   <span class="keywordtype">float</span> myWildPlantsPercentage = (100. - (sliderCrop-&gt;value()))*.01;
<a name="l00641"></a>00641   <span class="keywordtype">float</span> myCropPercentage = sliderCrop-&gt;value()*.01;
<a name="l00642"></a>00642 
<a name="l00643"></a>00643   <span class="keywordtype">float</span> myCaloriesIndividual = sbDailyCalories-&gt;value();
<a name="l00644"></a>00644   <span class="keywordtype">float</span> myPopulation = sbPopulation-&gt;value();
<a name="l00645"></a>00645   <span class="keywordtype">float</span> myDairyUtilisation = sbDairyUtilisation-&gt;value()*.01;
<a name="l00646"></a>00646 
<a name="l00647"></a>00647   <span class="keywordtype">float</span> myKCaloriesIndividualAnnual = (myCaloriesIndividual*365.)/1000.;
<a name="l00648"></a>00648   <span class="keywordtype">float</span> myMCaloriesSettlementAnnual = (myKCaloriesIndividualAnnual/1000.)*myPopulation;
<a name="l00649"></a>00649   
<a name="l00650"></a>00650   <span class="keywordtype">float</span> myTameAnimalMCalories;
<a name="l00651"></a>00651   <span class="keywordtype">float</span> myWildAnimalMCalories;
<a name="l00652"></a>00652   <span class="comment">//float myTameAnimalPortionPct;</span>
<a name="l00653"></a>00653   <span class="comment">//float myDairyPortionPct;</span>
<a name="l00654"></a>00654   <span class="keywordtype">float</span> myTameMeatPortionPct;
<a name="l00655"></a>00655   <span class="keywordtype">float</span> myAnimalPortionPct;
<a name="l00656"></a>00656   <span class="comment">//float myPlantsPortionPct;</span>
<a name="l00657"></a>00657   <span class="comment">//float myCropsPortionPct;</span>
<a name="l00658"></a>00658   <span class="comment">//float myWildPlantsPortionPct;</span>
<a name="l00659"></a>00659   <span class="keywordtype">float</span> myWildAnimalPortionPct;
<a name="l00660"></a>00660 
<a name="l00661"></a>00661 
<a name="l00662"></a>00662   
<a name="l00663"></a>00663   <span class="keywordflow">if</span> (labelCropCheck-&gt;text() != <span class="stringliteral">"100\%"</span> or labelAnimalCheck-&gt;text() != <span class="stringliteral">"100\%"</span>)
<a name="l00664"></a>00664      {
<a name="l00665"></a>00665        <span class="comment">//</span>
<a name="l00666"></a>00666      }
<a name="l00667"></a>00667      
<a name="l00668"></a>00668   <span class="keywordflow">else</span>
<a name="l00669"></a>00669       {
<a name="l00671"></a>00671         <span class="comment">//  define common variables  //</span>
<a name="l00673"></a>00673 <span class="comment"></span>        <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee47">AreaUnits</a> myAreaUnits = (cbAreaUnits-&gt;currentText() == <span class="stringliteral">"Dunum"</span>) ? <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee4710d869fda8ef9b3852491ed49722a677">Dunum</a> : <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee476bf9786325e8633eb9e90667c85b339d">Hectare</a>;
<a name="l00674"></a>00674         QMap&lt;QString,QString&gt; mySelectedAnimalsMap; <span class="comment">// &lt;animalGuid , animalparamtersGuid&gt;</span>
<a name="l00675"></a>00675         QMap&lt;QString,QString&gt; mySelectedCropsMap; <span class="comment">// &lt;cropGuid , cropParamterGuid&gt;  //</span>
<a name="l00676"></a>00676         <a class="code" href="classLaModel.html">LaModel</a> myModel;
<a name="l00678"></a>00678        <span class="comment">//  Get Selected Crops &amp; Animals  //</span>
<a name="l00680"></a>00680 <span class="comment"></span>        QMapIterator&lt;QString, QPair&lt;bool, QString&gt; &gt; myAnimalIterator(<a class="code" href="classLaMainForm.html#d6e0150e0845d22562f0c290babf94a8">mAnimalsMap</a>);
<a name="l00681"></a>00681         <span class="keywordflow">while</span> (myAnimalIterator.hasNext())
<a name="l00682"></a>00682               {
<a name="l00683"></a>00683                 myAnimalIterator.next();
<a name="l00684"></a>00684                 QPair&lt;bool,QString&gt; myPair = myAnimalIterator.value();
<a name="l00685"></a>00685                 QString myAnimalGuid = myAnimalIterator.key();
<a name="l00686"></a>00686                 QString myAnimalParameterGuid = myPair.second;
<a name="l00687"></a>00687                 <span class="keywordtype">bool</span> mySelectedFlag = myPair.first;
<a name="l00688"></a>00688                 <span class="keywordflow">if</span> (mySelectedFlag)
<a name="l00689"></a>00689                 {
<a name="l00690"></a>00690                   mySelectedAnimalsMap.insert(myAnimalGuid,myAnimalParameterGuid);
<a name="l00691"></a>00691                 }
<a name="l00692"></a>00692               }
<a name="l00693"></a>00693 
<a name="l00694"></a>00694         QMapIterator&lt;QString, QPair&lt;bool, QString&gt; &gt; myCropIterator(<a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>);
<a name="l00695"></a>00695         <span class="keywordflow">while</span> (myCropIterator.hasNext())
<a name="l00696"></a>00696               {
<a name="l00697"></a>00697                 myCropIterator.next();
<a name="l00698"></a>00698                 QPair&lt;bool,QString&gt; myPair = myCropIterator.value();
<a name="l00699"></a>00699                 QString myCropGuid = myCropIterator.key();
<a name="l00700"></a>00700                 QString myCropParameterGuid = myPair.second;
<a name="l00701"></a>00701                 <span class="keywordtype">bool</span> mySelectedFlag = myPair.first;
<a name="l00702"></a>00702                 <span class="keywordflow">if</span> (mySelectedFlag)
<a name="l00703"></a>00703                 {
<a name="l00704"></a>00704                   mySelectedCropsMap.insert(myCropGuid,myCropParameterGuid);
<a name="l00705"></a>00705                 }
<a name="l00706"></a>00706               }
<a name="l00707"></a>00707 
<a name="l00709"></a>00709        <span class="comment">// Set up the model with variables //</span>
<a name="l00711"></a>00711 <span class="comment"></span>        myModel.<a class="code" href="classLaModel.html#3e950192a55803924447f61b7dc46454">setCrops</a>(mySelectedCropsMap);
<a name="l00712"></a>00712         myModel.<a class="code" href="classLaModel.html#3fb9c4ca069ae6bf174ee32716be4f3e">setAnimals</a>(mySelectedAnimalsMap);
<a name="l00713"></a>00713         QString mySelectedAreaUnit = QString(cbAreaUnits-&gt;currentText());
<a name="l00714"></a>00714         myModel.<a class="code" href="classLaModel.html#ec8302dc43a3e116a71102ce472a349d">setName</a>(lineEditSiteName-&gt;text());
<a name="l00715"></a>00715         myModel.<a class="code" href="classLaModel.html#0df5246fe38351aee25b2e1bdcb688bb">setPopulation</a>(sbPopulation-&gt;value());
<a name="l00716"></a>00716         myModel.<a class="code" href="classLaModel.html#454e3d008c0a77c30308ae488040ffa7">setPeriod</a>(lineEditPeriod-&gt;text());
<a name="l00717"></a>00717         myModel.<a class="code" href="classLaModel.html#8afd3dedeb93cda39f32844bd09270e2">setEasting</a>(lineEditEasting-&gt;text().toInt());
<a name="l00718"></a>00718         myModel.<a class="code" href="classLaModel.html#f742cc7a4e7591118898cfd223d41bc5">setNorthing</a>(lineEditNorthing-&gt;text().toInt());
<a name="l00719"></a>00719         myModel.<a class="code" href="classLaModel.html#3c7d7805d6578fb1214de7e3674bc660">setEuclideanDistance</a>(radioButtonEuclidean-&gt;isChecked());
<a name="l00720"></a>00720         myModel.<a class="code" href="classLaModel.html#401d2e8d3f01ceb5ff888d88e384684f">setWalkingTime</a>(radioButtonWalkingTime-&gt;isChecked());
<a name="l00721"></a>00721         myModel.<a class="code" href="classLaModel.html#62a4c6f93819b550d794a130722fe22a">setPathDistance</a>(radioButtonPathDistance-&gt;isChecked());
<a name="l00722"></a>00722         myModel.<a class="code" href="classLaModel.html#548b3fc043af8279bca2d50135224e3e">setPrecision</a>(sbModelPrecision-&gt;value());
<a name="l00723"></a>00723         myModel.<a class="code" href="classLaModel.html#ef1f55740dd5c8990fd0652527757d82">setDietPercent</a>(sliderDiet-&gt;value());
<a name="l00724"></a>00724         myModel.<a class="code" href="classLaModel.html#4a7fd16108be2ea4763c5cc25459a67f">setCropPercent</a>(sliderCrop-&gt;value());
<a name="l00725"></a>00725         myModel.<a class="code" href="classLaModel.html#d357afcd0c2ce4248132e5d1329a635b">setMeatPercent</a>(sliderMeat-&gt;value());
<a name="l00726"></a>00726         myModel.<a class="code" href="classLaModel.html#54b2d5d6cbd3b15565ef409b8fb3a832">setCaloriesPerPersonDaily</a>(sbDailyCalories-&gt;value());
<a name="l00727"></a>00727         QString myAreaUnitsText = (cbAreaUnits-&gt;currentText());
<a name="l00728"></a>00728         myModel.<a class="code" href="classLaModel.html#da1b51b4c42d015dcffa831cee047f64">setCommonLandAreaUnits</a>(myAreaUnits);
<a name="l00729"></a>00729         myModel.<a class="code" href="classLaModel.html#3716d84e3fd60739f6461e52c046988c">setBaseOnPlants</a>(cboxBaseOnPlants-&gt;isChecked());
<a name="l00730"></a>00730         myModel.<a class="code" href="classLaModel.html#b9907f392b099c88de7ea10eaa22c844">setIncludeDairy</a>(cboxIncludeDairy-&gt;isChecked());
<a name="l00731"></a>00731         myModel.<a class="code" href="classLaModel.html#f4b301f0647720b442af02641ee2f190">setLimitDairy</a>(cboxIncludeDairy-&gt;isChecked());
<a name="l00732"></a>00732         myModel.<a class="code" href="classLaModel.html#e6f84f9a173cd23112d3c716c5672309">setLimitDairyPercent</a>(sbLimitDairyPercent-&gt;value());
<a name="l00733"></a>00733         myModel.<a class="code" href="classLaModel.html#88f82368ffc9be6afea709dee7ee715e">setDairyUtilisation</a>(sbDairyUtilisation-&gt;value());
<a name="l00734"></a>00734         myModel.<a class="code" href="classLaModel.html#a74a5a9cb35abb0b28b44794b1285277">setCommonLandValue</a>(sbCommonRasterValue-&gt;value(), myAreaUnits);
<a name="l00735"></a>00735         myModel.<a class="code" href="classLaModel.html#e9867f7eb061ea3e6753f1769936d60a">DoCalculations</a>();
<a name="l00736"></a>00736 
<a name="l00738"></a>00738        <span class="comment">//  Count all Calories from Dairy  //</span>
<a name="l00740"></a>00740 <span class="comment"></span>          <span class="comment">//  Iterate through all the animals  //</span>
<a name="l00741"></a>00741          <span class="comment">//  calculate calories from all the  //</span>
<a name="l00742"></a>00742         <span class="comment">//  dairy and multiply by the value  //</span>
<a name="l00743"></a>00743        <span class="comment">//  set for their dairy utilisation  //</span>
<a name="l00745"></a>00745 <span class="comment"></span>
<a name="l00746"></a>00746         <span class="keywordtype">float</span> myDairyMCalorieCounter = 0.0;
<a name="l00747"></a>00747         <a class="code" href="la_8h.html#a6e218ff30dc80f7359647374284098f">LaFoodSourceMap</a> myHerdMCalorieCounterMap;
<a name="l00748"></a>00748         QMapIterator &lt;QString, QString&gt; myNextAnimalIterator(mySelectedAnimalsMap);
<a name="l00749"></a>00749         <span class="keywordflow">while</span> (myNextAnimalIterator.hasNext())
<a name="l00750"></a>00750               {
<a name="l00751"></a>00751                 myNextAnimalIterator.next();
<a name="l00752"></a>00752                 <span class="comment">//LaAnimal myAnimal = LaUtils::getAnimal(</span>
<a name="l00753"></a>00753                 QString myAnimalGuid = myNextAnimalIterator.key();
<a name="l00754"></a>00754                 QString myAnimalParameterGuid = myNextAnimalIterator.key();
<a name="l00755"></a>00755                 <a class="code" href="classLaAnimal.html">LaAnimal</a> myAnimal = <a class="code" href="classLaUtils.html#31401524c3416531ef439851cd69cd21">LaUtils::getAnimal</a>(myAnimalGuid);
<a name="l00756"></a>00756                 <a class="code" href="classLaAnimalParameter.html">LaAnimalParameter</a> myAnimalParameter = <a class="code" href="classLaUtils.html#fd9d58e854e54a9ce823ebe0b177471f">LaUtils::getAnimalParameter</a>(myAnimalParameterGuid);
<a name="l00757"></a>00757                 <a class="code" href="la_8h.html#bb42bbf9afe96b2b9f407b2575d71117">HerdSize</a> myHerdSize = myModel.<a class="code" href="classLaModel.html#e0e616403a10073e061bd6e062555b72">herdSize</a>(myAnimalGuid); <span class="comment">// this will be adjusted for dairy inclusion if selected</span>
<a name="l00758"></a>00758                 <span class="comment">// calories required for Juveniles</span>
<a name="l00759"></a>00759                 <span class="keywordtype">float</span> myNumberOfJuveniles = myHerdSize.second;
<a name="l00760"></a>00760                 <span class="keywordtype">float</span> myJuvenilesPerKg = myAnimal.<a class="code" href="classLaAnimal.html#5869a81693b62d835fe18aa85e718817">juvenile</a>(); <span class="comment">//daily caloric requirements (per kg)</span>
<a name="l00761"></a>00761                 <span class="keywordtype">float</span> myJuvenilesGrowTime = myAnimal.<a class="code" href="classLaAnimal.html#c53a3c881ead54974b0a2691800a9ac4">growTime</a>() * 7.; <span class="comment">// (converted to) age in days of animal at slaughter</span>
<a name="l00762"></a>00762                 <span class="keywordtype">float</span> myJuvenilesKillWeight = myAnimal.<a class="code" href="classLaAnimal.html#b91d79421a1a113f463ced406e2b89e5">killWeight</a>(); <span class="comment">// weight in kg of animal when slaughtered</span>
<a name="l00763"></a>00763                 <span class="keywordtype">float</span> myWeaningWeight = myAnimal.<a class="code" href="classLaAnimal.html#3bdeb417f81ec534247599d56868d954">weaningWeight</a>();
<a name="l00764"></a>00764                 <span class="keywordtype">float</span> myWeaningAge = myAnimal.<a class="code" href="classLaAnimal.html#2f81a4cfb201673bb23bfb9d1098c7b9">weaningAge</a>();
<a name="l00765"></a>00765                 <span class="keywordtype">float</span> myDaysToGain = myJuvenilesGrowTime - myAnimal.<a class="code" href="classLaAnimal.html#2f81a4cfb201673bb23bfb9d1098c7b9">weaningAge</a>();
<a name="l00766"></a>00766                 <span class="comment">// arithmetic progression used to get calories required to</span>
<a name="l00767"></a>00767                 <span class="comment">// get an animal from weaning to slaughter</span>
<a name="l00768"></a>00768                 <span class="keywordtype">float</span> myTotalJuvenileKg = (myWeaningWeight+myJuvenilesKillWeight)*((static_cast&lt;float&gt;(myDaysToGain))/2.);
<a name="l00769"></a>00769                 <span class="keywordtype">float</span> myJuvenileKCalories = (myJuvenilesPerKg * myTotalJuvenileKg)/1000.;
<a name="l00770"></a>00770                 <span class="keywordtype">float</span> myJuvenileHerdRequiresMCalories = (myJuvenileKCalories * myNumberOfJuveniles)/1000.;
<a name="l00771"></a>00771 
<a name="l00772"></a>00772                 qDebug() &lt;&lt; <span class="stringliteral">"Juvenile Weaning Weight: "</span> &lt;&lt; myWeaningWeight;
<a name="l00773"></a>00773                 qDebug() &lt;&lt; <span class="stringliteral">"Juvenile Kill Weight: "</span> &lt;&lt; myJuvenilesKillWeight;
<a name="l00774"></a>00774                 qDebug() &lt;&lt; <span class="stringliteral">"Juvenile Grow Time: "</span> &lt;&lt; myJuvenilesGrowTime;
<a name="l00775"></a>00775                 qDebug() &lt;&lt; <span class="stringliteral">"Juvenile Weaning Age: "</span> &lt;&lt; myWeaningAge;
<a name="l00776"></a>00776                 qDebug() &lt;&lt; <span class="stringliteral">"Juvenile Total Kg: "</span> &lt;&lt; myTotalJuvenileKg;
<a name="l00777"></a>00777                 qDebug() &lt;&lt; <span class="stringliteral">"Juvenile Total KCalories per individual: "</span> &lt;&lt; myJuvenileKCalories;
<a name="l00778"></a>00778                 qDebug() &lt;&lt; <span class="stringliteral">"Juvenile Herd Requires MCalories per year: "</span> &lt;&lt; myJuvenileHerdRequiresMCalories;
<a name="l00779"></a>00779 
<a name="l00780"></a>00780                 <span class="comment">// calories required for adult females</span>
<a name="l00781"></a>00781                 <span class="comment">// as they are either lactating, pregnant or on a maintenance diet</span>
<a name="l00782"></a>00782                 <span class="comment">// their requirements are:</span>
<a name="l00783"></a>00783                 <span class="comment">//  whileLactatingCaloriesRequired * daysLactating +</span>
<a name="l00784"></a>00784                 <span class="comment">//   whilePregnantCaloriesRequired * daysPregnant  +</span>
<a name="l00785"></a>00785                 <span class="comment">//    whileOnMaintenanceCaloriesRequired * daysOnMaintenanceRations</span>
<a name="l00786"></a>00786                 <span class="keywordtype">float</span> myNumberOfAdultFemales = myHerdSize.first;
<a name="l00787"></a>00787                 <span class="comment">// don't forget that the birthing cycle might not be yearly. must adjust for that</span>
<a name="l00788"></a>00788                 <span class="comment">// because I need yearly calorie targets so will adjust the time to be a function</span>
<a name="l00789"></a>00789                 <span class="comment">// of the cycle</span>
<a name="l00790"></a>00790                 <span class="keywordtype">float</span> myBirthingEventsPerYear = 365.0 / <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>((myAnimal.<a class="code" href="classLaAnimal.html#87182421ad69e1361460b1a9de1ef477">gestationTime</a>()) + static_cast&lt;float&gt;(myAnimal.<a class="code" href="classLaAnimal.html#a8d0331bd199fca790f88ab491ec99be">estrousCycle</a>()) + static_cast&lt;float&gt;(myAnimal.<a class="code" href="classLaAnimal.html#2f81a4cfb201673bb23bfb9d1098c7b9">weaningAge</a>()));
<a name="l00791"></a>00791                 <span class="keywordtype">float</span> myAdultFemalesGestatingNeeds = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(myAnimal.<a class="code" href="classLaAnimal.html#bd2e2feff05f8cdc5c47524fbc5a6016">gestating</a>());
<a name="l00792"></a>00792                 <span class="keywordtype">float</span> myAdultFemalesGestationTime = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(myAnimal.<a class="code" href="classLaAnimal.html#87182421ad69e1361460b1a9de1ef477">gestationTime</a>()) * myBirthingEventsPerYear;
<a name="l00793"></a>00793                 <span class="keywordtype">float</span> myAdultFemalesLactatingNeeds = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(myAnimal.<a class="code" href="classLaAnimal.html#a512909d315fb347ad19c861f73c953f">lactating</a>());
<a name="l00794"></a>00794                 <span class="keywordtype">float</span> myAdultFemalesLactationTime = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(myAnimal.<a class="code" href="classLaAnimal.html#d68b0eee8228151e81ba937c7715a300">lactationTime</a>()) * myBirthingEventsPerYear;
<a name="l00795"></a>00795                 <span class="keywordtype">float</span> myAdultFemalesMaintenanceNeeds = myAnimal.<a class="code" href="classLaAnimal.html#c9556c5a2833bb79834b276aca8a5eb8">maintenance</a>();
<a name="l00796"></a>00796                 <span class="keywordtype">float</span> myAdultFemalesMaintenanceTime = (365.*myBirthingEventsPerYear) - myAdultFemalesGestationTime - myAdultFemalesLactationTime;
<a name="l00797"></a>00797 
<a name="l00798"></a>00798                 <span class="keywordtype">float</span> myGestatingRequiresKCalories = (myAdultFemalesGestatingNeeds * myAdultFemalesGestationTime)/1000.;
<a name="l00799"></a>00799                 <span class="keywordtype">float</span> myLactatingRequiresKCalories = (myAdultFemalesLactatingNeeds * myAdultFemalesLactationTime)/1000.;
<a name="l00800"></a>00800                 <span class="keywordtype">float</span> myMaintenanceRequiresKCalories = (myAdultFemalesMaintenanceNeeds * myAdultFemalesMaintenanceTime)/1000.;
<a name="l00801"></a>00801 
<a name="l00802"></a>00802                 <span class="keywordtype">float</span> myGestatingHerdRequiresMCalories   = (myGestatingRequiresKCalories   * myNumberOfAdultFemales)/1000.;
<a name="l00803"></a>00803                 <span class="keywordtype">float</span> myLactatingHerdRequiresMCalories   = (myLactatingRequiresKCalories   * myNumberOfAdultFemales)/1000.;
<a name="l00804"></a>00804                 <span class="keywordtype">float</span> myMaintenanceHerdRequiresMCalories = (myMaintenanceRequiresKCalories * myNumberOfAdultFemales)/1000.;
<a name="l00805"></a>00805 
<a name="l00806"></a>00806                 <span class="keywordtype">float</span> myHerdRequires = myJuvenileHerdRequiresMCalories + myGestatingHerdRequiresMCalories + myLactatingHerdRequiresMCalories + myMaintenanceHerdRequiresMCalories;
<a name="l00807"></a>00807 
<a name="l00808"></a>00808                 qDebug() &lt;&lt; <span class="stringliteral">"Herd Size: Mothers,Juveniles"</span> &lt;&lt; myHerdSize;
<a name="l00809"></a>00809                 qDebug() &lt;&lt; <span class="stringliteral">"Gestating Individual Requires MCalories per year: "</span> &lt;&lt; myGestatingRequiresKCalories;
<a name="l00810"></a>00810                 qDebug() &lt;&lt; <span class="stringliteral">"Lactating Individual Requires MCalories per year: "</span> &lt;&lt; myLactatingRequiresKCalories;
<a name="l00811"></a>00811                 qDebug() &lt;&lt; <span class="stringliteral">"Maintenance Individual Requires MCalories per year: "</span> &lt;&lt; myMaintenanceRequiresKCalories;
<a name="l00812"></a>00812                 qDebug() &lt;&lt; <span class="stringliteral">"Gestating Herd Requires MCalories per year: "</span> &lt;&lt; myGestatingHerdRequiresMCalories;
<a name="l00813"></a>00813                 qDebug() &lt;&lt; <span class="stringliteral">"Lactating Herd Requires MCalories per year: "</span> &lt;&lt; myLactatingRequiresKCalories;
<a name="l00814"></a>00814                 qDebug() &lt;&lt; <span class="stringliteral">"Maintenance Herd Requires MCalories per year: "</span> &lt;&lt; myMaintenanceHerdRequiresMCalories;
<a name="l00815"></a>00815                 qDebug() &lt;&lt; <span class="stringliteral">"myHerdRequires MCalories per Year: "</span> &lt;&lt; myHerdRequires;
<a name="l00816"></a>00816                 <span class="keywordtype">bool</span> myGrazingSupplementedFlag = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(myAnimalParameter.<a class="code" href="classLaAnimalParameter.html#1a5493b41223ba963b8a4d5af0d393f2">fodderUse</a>());
<a name="l00817"></a>00817 
<a name="l00818"></a>00818                 <span class="keywordflow">if</span> (myGrazingSupplementedFlag)
<a name="l00819"></a>00819                    {   <span class="comment">//  here i can get the additional calories needed from the crops to feed the animals</span>
<a name="l00820"></a>00820                        <span class="comment">//  by cycling through the crops used as feed and  inserting into the myHerdMCalorieCounterMap</span>
<a name="l00821"></a>00821                    }
<a name="l00822"></a>00822 
<a name="l00823"></a>00823                 <span class="keywordtype">float</span> myMilkKgPerDay = myAnimal.<a class="code" href="classLaAnimal.html#918d84cabe24ef0714339a54b0663d3f">milkGramsPerDay</a>() / 1000.;
<a name="l00824"></a>00824                 <span class="keywordtype">float</span> myMilkFoodValue = myAnimal.<a class="code" href="classLaAnimal.html#60b8c9abf2c857227ea81d694eec18b6">milkFoodValue</a>();
<a name="l00825"></a>00825                 <span class="keywordtype">float</span> myDaysOfMilking = myAnimal.<a class="code" href="classLaAnimal.html#d68b0eee8228151e81ba937c7715a300">lactationTime</a>() - myWeaningAge;
<a name="l00826"></a>00826                 <span class="keywordtype">float</span> myKCaloriesFromMilk = (myNumberOfAdultFemales * myDaysOfMilking * myMilkFoodValue * myMilkKgPerDay)/1000.;
<a name="l00827"></a>00827                 <span class="keywordtype">float</span> myMCaloriesFromMilk = myKCaloriesFromMilk/1000.;
<a name="l00828"></a>00828                 myDairyMCalorieCounter += myMCaloriesFromMilk;
<a name="l00829"></a>00829                 qDebug() &lt;&lt; <span class="stringliteral">"Adding "</span> &lt;&lt; myKCaloriesFromMilk &lt;&lt; <span class="stringliteral">" KCalories to total KCalories from milk which is now at: "</span> &lt;&lt; myDairyMCalorieCounter &lt;&lt; <span class="stringliteral">"MCalories"</span>;
<a name="l00830"></a>00830               }
<a name="l00832"></a>00832        <span class="comment">//  Perform final calculations //</span>
<a name="l00834"></a>00834 <span class="comment"></span>        <span class="comment">//float myTameAnimalMCalories;</span>
<a name="l00835"></a>00835         <span class="keywordtype">float</span> myDairyMCalories;<span class="comment">// = (myDairyUtilisation*.01) * myDairyMCalorieCounter*1000.;</span>
<a name="l00836"></a>00836         <span class="comment">//float myPlantsMCalories;// = (myMCaloriesSettlementAnnual - myDairyMCalories - myTameAnimalMCalories - myWildAnimalMCalories);</span>
<a name="l00837"></a>00837         <span class="keywordtype">float</span> myDairyPortionPct;<span class="comment">// = (myDairyMCalories/myMCaloriesSettlementAnnual)*100.;</span>
<a name="l00838"></a>00838         <span class="keywordtype">float</span> myWildPlantsPortionPct;<span class="comment">// = (myPlantsMCalories/myMCaloriesSettlementAnnual)*100.*((myWildPlantPercentage)*.01);</span>
<a name="l00839"></a>00839         <span class="keywordtype">float</span> myCropsPortionPct;<span class="comment">// = (myPlantsMCalories/myMCaloriesSettlementAnnual)*100.*((myCropPercentage)*.01);</span>
<a name="l00840"></a>00840         
<a name="l00841"></a>00841         <span class="keywordtype">float</span> myWildPlantsMCalories;<span class="comment">// = (myPlantsMCalories*myWildPlantsPercentage*.01);</span>
<a name="l00842"></a>00842         <span class="keywordtype">float</span> myCropMCalories;<span class="comment">// = (myPlantsMCalories*(myCropsPercentage*.01));</span>
<a name="l00843"></a>00843         <span class="keywordtype">float</span> myPlantsPortionPct;<span class="comment">// = myPlantsMCalories/myMCaloriesSettlementAnnual*100.;</span>
<a name="l00844"></a>00844         <span class="comment">//float myMeatPortionPct;// = ((myTameAnimalMCalories + myWildAnimalMCalories) / myMCaloriesSettlementAnnual)*100.;</span>
<a name="l00845"></a>00845 
<a name="l00846"></a>00846         <span class="keywordflow">if</span> (myModel.<a class="code" href="classLaModel.html#7a26875101f02cca40f0067ce79a720c">baseOnPlants</a>()) <span class="comment">// base the calculations on plants first and derive meat contribution</span>
<a name="l00847"></a>00847         {
<a name="l00848"></a>00848           <span class="keywordflow">if</span>  (myModel.<a class="code" href="classLaModel.html#8a3504ddb9688e7ebc2894bed050c158">includeDairy</a>())
<a name="l00849"></a>00849           {
<a name="l00850"></a>00850 <span class="comment">//</span>
<a name="l00851"></a>00851           } <span class="comment">// end includeDairy TRUE</span>
<a name="l00852"></a>00852           <span class="keywordflow">else</span>
<a name="l00853"></a>00853           {
<a name="l00854"></a>00854 <span class="comment">//</span>
<a name="l00855"></a>00855           } <span class="comment">// end includeDairy FALSE</span>
<a name="l00856"></a>00856         }<span class="comment">// end baseOnPlants TRUE</span>
<a name="l00857"></a>00857         <span class="keywordflow">else</span> <span class="comment">// base the calculations on meat (or meat &amp; dairy) first and derive plant contribution</span>
<a name="l00858"></a>00858         {
<a name="l00859"></a>00859           <span class="keywordflow">if</span>  (myModel.<a class="code" href="classLaModel.html#8a3504ddb9688e7ebc2894bed050c158">includeDairy</a>())
<a name="l00860"></a>00860               { <span class="comment">// base the calculations on meat &amp; Dairy</span>
<a name="l00861"></a>00861                 myDairyMCalories = (myDairyUtilisation) * myDairyMCalorieCounter;
<a name="l00862"></a>00862                 myDairyPortionPct = myDairyMCalories / myMCaloriesSettlementAnnual;<span class="comment">// done</span>
<a name="l00863"></a>00863                 <span class="keywordtype">float</span> myPercentOfCalorieTarget = myMCaloriesSettlementAnnual * myDietPercentMeat;
<a name="l00864"></a>00864                 <span class="keywordtype">float</span> myAnimalCalsMinusDairyBit = myPercentOfCalorieTarget - myDairyMCalories;
<a name="l00865"></a>00865                 myWildAnimalMCalories = myAnimalCalsMinusDairyBit * myWildMeatPercentage;
<a name="l00866"></a>00866                 myTameAnimalMCalories = myAnimalCalsMinusDairyBit * myTameMeatPercentage;
<a name="l00867"></a>00867                 myWildAnimalPortionPct = myWildAnimalMCalories / myMCaloriesSettlementAnnual;
<a name="l00868"></a>00868                 myTameMeatPortionPct = myTameAnimalMCalories / myMCaloriesSettlementAnnual;
<a name="l00869"></a>00869 
<a name="l00870"></a>00870                 myPlantsPortionPct = 1. - myAnimalPortionPct;
<a name="l00871"></a>00871                 myCropsPortionPct = myPlantsPortionPct * myCropPercentage;
<a name="l00872"></a>00872                 myWildPlantsPortionPct = myPlantsPortionPct * myWildPlantsPercentage;
<a name="l00873"></a>00873                 myCropMCalories = myMCaloriesSettlementAnnual * myCropsPortionPct;
<a name="l00874"></a>00874                 myWildPlantsMCalories = myMCaloriesSettlementAnnual * myWildPlantsPortionPct;
<a name="l00875"></a>00875 
<a name="l00876"></a>00876                 qDebug() &lt;&lt; <span class="stringliteral">"   ---   myDairyMCalories:"</span> &lt;&lt; myDairyMCalories;
<a name="l00877"></a>00877                 qDebug() &lt;&lt; <span class="stringliteral">"   ---   myDairyPortionPct:"</span> &lt;&lt; myDairyPortionPct;
<a name="l00878"></a>00878                 qDebug() &lt;&lt; <span class="stringliteral">"   ---   myTameAnimalMCalories:"</span> &lt;&lt; myTameAnimalMCalories;
<a name="l00879"></a>00879                 qDebug() &lt;&lt; <span class="stringliteral">"   ---   myTameMeatPortionPct:"</span> &lt;&lt; myTameMeatPortionPct;
<a name="l00880"></a>00880                 qDebug() &lt;&lt; <span class="stringliteral">"   ---   myAnimalPortionPct:"</span> &lt;&lt; myAnimalPortionPct;
<a name="l00881"></a>00881                 qDebug() &lt;&lt; <span class="stringliteral">"   ---   myPlantsPortionPct:"</span> &lt;&lt; myPlantsPortionPct;
<a name="l00882"></a>00882                 qDebug() &lt;&lt; <span class="stringliteral">"   ---   myCropsPortionPct:"</span> &lt;&lt; myCropsPortionPct;
<a name="l00883"></a>00883                 qDebug() &lt;&lt; <span class="stringliteral">"   ---   myWildPlantsPortionPct:"</span> &lt;&lt; myWildPlantsPortionPct;
<a name="l00884"></a>00884                 qDebug() &lt;&lt; <span class="stringliteral">"   ---   myWildAnimalPortionPct:"</span> &lt;&lt; myWildAnimalPortionPct;
<a name="l00885"></a>00885                 qDebug() &lt;&lt; <span class="stringliteral">"   ---   myCropMCalories:"</span> &lt;&lt; myCropMCalories;
<a name="l00886"></a>00886                 qDebug() &lt;&lt; <span class="stringliteral">"   ---   myWildAnimalMCalories:"</span> &lt;&lt; myWildAnimalMCalories;
<a name="l00887"></a>00887                 qDebug() &lt;&lt; <span class="stringliteral">"   ---   myWildPlantsMCalories:"</span> &lt;&lt; myWildPlantsMCalories;
<a name="l00888"></a>00888 
<a name="l00890"></a>00890                 <span class="comment">//  Update the labels with values  //</span>
<a name="l00892"></a>00892 <span class="comment"></span>                labelCaloriesDairy-&gt;setText(QString::number(myDairyMCalories));
<a name="l00893"></a>00893                 labelCaloriesCrops-&gt;setText(QString::number(myCropMCalories));
<a name="l00894"></a>00894                 labelCaloriesWildMeat-&gt;setText(QString::number(myWildAnimalMCalories));
<a name="l00895"></a>00895                 labelCaloriesWildPlants-&gt;setText(QString::number(myWildPlantsMCalories));
<a name="l00896"></a>00896 
<a name="l00897"></a>00897                 labelPortionAllDairy-&gt;setText(QString::number(myDairyPortionPct*100.));
<a name="l00898"></a>00898                 labelPortionTameMeat-&gt;setText(QString::number(myTameMeatPortionPct*100.));
<a name="l00899"></a>00899                 labelPortionDairy-&gt;setText(QString::number(myDairyPortionPct*100.));
<a name="l00900"></a>00900                 labelPortionCrops-&gt;setText(QString::number(myCropsPortionPct*100.));
<a name="l00901"></a>00901                 labelPortionWildMeat-&gt;setText(QString::number(myWildAnimalPortionPct*100.));
<a name="l00902"></a>00902                 labelPortionWildPlants-&gt;setText(QString::number(myWildPlantsPortionPct*100.));
<a name="l00903"></a>00903                 labelPortionPlants-&gt;setText(QString::number(myPlantsPortionPct*100.));
<a name="l00904"></a>00904                 labelPortionMeat-&gt;setText(QString::number(myAnimalPortionPct*100.));
<a name="l00905"></a>00905               } <span class="comment">// end includeDairy TRUE</span>
<a name="l00906"></a>00906           <span class="keywordflow">else</span>
<a name="l00907"></a>00907               { <span class="comment">// base the calculations on meat</span>
<a name="l00908"></a>00908                 <span class="comment">//</span>
<a name="l00909"></a>00909               } <span class="comment">// end includeDairy FALSE</span>
<a name="l00910"></a>00910         }<span class="comment">// end baseOnPlants FALSE</span>
<a name="l00911"></a>00911       }
<a name="l00912"></a>00912   
<a name="l00913"></a>00913   <span class="comment">//float myTameCropkCalories = (myTameCropPercentage*.01)*mykCaloriesSettlementAnnual;</span>
<a name="l00914"></a>00914   labelCaloriesIndividual-&gt;setText(QString::number(myKCaloriesIndividualAnnual));
<a name="l00915"></a>00915   labelCaloriesSettlement-&gt;setText(QString::number(myMCaloriesSettlementAnnual));
<a name="l00916"></a>00916   <span class="comment">//labelCaloriesWildPlants-&gt;setText(QString::number(myWildPlantsMCalories));</span>
<a name="l00917"></a>00917   <span class="comment">//labelCaloriesWildMeat-&gt;setText(QString::number(myWildAnimalMCalories));</span>
<a name="l00918"></a>00918   
<a name="l00919"></a>00919   <span class="comment">//labelPortionCrops-&gt;setText(QString::number(static_cast &lt;int&gt;(myTameCropPercentage)));</span>
<a name="l00920"></a>00920   <span class="comment">//labelPortionTameMeat-&gt;setText(QString::number(myTameMeatPercentage));</span>
<a name="l00921"></a>00921 
<a name="l00922"></a>00922 }
<a name="l00923"></a>00923 
<a name="l00924"></a>00924 
<a name="l00925"></a>00925 
<a name="l00926"></a>00926 
<a name="l00927"></a>00927 
<a name="l00928"></a>00928 
<a name="l00929"></a>00929 
<a name="l00930"></a>00930 
<a name="l00931"></a>00931 
<a name="l00932"></a>00932 
<a name="l00933"></a>00933 
<a name="l00934"></a>00934 
<a name="l00935"></a>00935 
<a name="l00936"></a>00936 
<a name="l00937"></a>00937 
<a name="l00938"></a>00938 
<a name="l00939"></a>00939 
<a name="l00940"></a>00940 
<a name="l00941"></a>00941 
<a name="l00942"></a>00942 
<a name="l00943"></a>00943 
<a name="l00944"></a>00944 
<a name="l00945"></a>00945 
<a name="l00946"></a>00946 
<a name="l00947"></a>00947 
<a name="l00948"></a><a class="code" href="classLaMainForm.html#ff6ccbd0a4bf64eb58d8c7b2d5e29ce9">00948</a> <span class="keywordtype">double</span> <a class="code" href="classLaMainForm.html#ff6ccbd0a4bf64eb58d8c7b2d5e29ce9">LaMainForm::totalWeightFromLinearGrowth</a>(<span class="keywordtype">float</span> theDaysToGain, <span class="keywordtype">float</span> theGainPerDay)
<a name="l00949"></a>00949 {
<a name="l00950"></a>00950   <span class="keywordflow">if</span> (theDaysToGain &gt; 0)
<a name="l00951"></a>00951   {
<a name="l00952"></a>00952     <span class="comment">//qDebug() &lt;&lt; "totalWeightFromLinearGrowth " &lt;&lt; theDaysToGain;</span>
<a name="l00953"></a>00953     <span class="comment">//mWeightCounter += theDaysToGain * totalWeightFromLinearGrowth;</span>
<a name="l00954"></a>00954     <span class="keywordflow">return</span> (theDaysToGain * <a class="code" href="classLaMainForm.html#ff6ccbd0a4bf64eb58d8c7b2d5e29ce9">totalWeightFromLinearGrowth</a> ((theDaysToGain - theGainPerDay),theGainPerDay));
<a name="l00955"></a>00955   }
<a name="l00956"></a>00956   <span class="keywordflow">else</span>
<a name="l00957"></a>00957   {
<a name="l00958"></a>00958     <span class="comment">//qDebug() &lt;&lt; "final Value: " &lt;&lt; totalWeightFromLinearGrowth;</span>
<a name="l00959"></a>00959     <span class="keywordflow">return</span> 1;<span class="comment">// totalWeightFromLinearGrowth;</span>
<a name="l00960"></a>00960   }
<a name="l00961"></a>00961 }
<a name="l00962"></a>00962 
<a name="l00963"></a><a class="code" href="classLaMainForm.html#c9f7b04b7ccd3078ad6479f54fb64aa6">00963</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#c9f7b04b7ccd3078ad6479f54fb64aa6">LaMainForm::animalCellClicked</a>(<span class="keywordtype">int</span> theRow, <span class="keywordtype">int</span> theColumn)
<a name="l00964"></a>00964 {
<a name="l00965"></a>00965   listWidgetCalculationsAnimal-&gt;clear();
<a name="l00966"></a>00966     <span class="comment">//qDebug("LaMainForm::animalCellClicked");</span>
<a name="l00967"></a>00967   QTableWidgetItem* mypItem = tblAnimals-&gt;item(tblAnimals-&gt;currentRow(),1);
<a name="l00968"></a>00968   <span class="keywordflow">if</span> (mypItem)
<a name="l00969"></a>00969   {
<a name="l00970"></a>00970     QString myGuid = mypItem-&gt;data(Qt::UserRole).toString();
<a name="l00971"></a>00971       <span class="comment">//QString myGuid = tblAnimals-&gt;item(tblAnimals-&gt;currentRow(),1)-&gt;data(Qt::UserRole).toString();</span>
<a name="l00972"></a>00972       <span class="comment">//get all animals, then get the animal for this cell if it exists</span>
<a name="l00973"></a>00973     QMap&lt;QString,LaAnimal&gt; myAnimalsMap = <a class="code" href="classLaUtils.html#aa01841fb18f566d8c2668fe5de5fc44">LaUtils::getAvailableAnimals</a>();
<a name="l00974"></a>00974     <a class="code" href="classLaAnimal.html">LaAnimal</a> myAnimal = myAnimalsMap[myGuid];
<a name="l00975"></a>00975     QComboBox * mypCombo=<span class="keyword">dynamic_cast&lt;</span>QComboBox *<span class="keyword">&gt;</span>(tblAnimals-&gt;cellWidget(tblAnimals-&gt;currentRow(),2));
<a name="l00976"></a>00976     myGuid = mypCombo-&gt;itemData(mypCombo-&gt;currentIndex(),Qt::UserRole).toString();
<a name="l00977"></a>00977       <span class="comment">//get all animal parameters, then get the animal parameter for this cell if it exists</span>
<a name="l00978"></a>00978     <a class="code" href="classLaUtils.html#bb3eaf59e992919e8a872d05f0bf85ac">LaUtils::AnimalParameterMap</a> myAnimalParametersMap;
<a name="l00979"></a>00979     myAnimalParametersMap = <a class="code" href="classLaUtils.html#435911951413b858799a013a01b47586">LaUtils::getAvailableAnimalParameters</a>();
<a name="l00980"></a>00980     <a class="code" href="classLaAnimalParameter.html">LaAnimalParameter</a> myAnimalParameter = myAnimalParametersMap[myGuid];
<a name="l00981"></a>00981     <a class="code" href="classLaMainForm.html#8e0e3226dd89f0b6d9dfcbb3c75d83ca">showAnimalDefinitionReport</a>(myAnimal,myAnimalParameter);
<a name="l00982"></a>00982     lblAnimalPix-&gt;setPixmap(myAnimal.<a class="code" href="classLaAnimal.html#a864020562f76302ad279c569ebf96c7">imageFile</a>());
<a name="l00983"></a>00983   }
<a name="l00984"></a>00984   listWidgetCalculationsAnimal-&gt;clear();
<a name="l00985"></a>00985   <a class="code" href="classLaMainForm.html#24c1d965173ef16dcae46a89f2e6c0e1">loadAnimals</a>();
<a name="l00986"></a>00986 }
<a name="l00987"></a>00987 
<a name="l00988"></a><a class="code" href="classLaMainForm.html#4a3596e1cd7c53a2000ba110c94b3aae">00988</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#4a3596e1cd7c53a2000ba110c94b3aae">LaMainForm::animalCellChanged</a>(<span class="keywordtype">int</span> theRow, <span class="keywordtype">int</span> theColumn)
<a name="l00989"></a>00989 {
<a name="l00990"></a>00990     <span class="comment">//listWidgetCalculationsAnimal-&gt;clear();</span>
<a name="l00991"></a>00991   QTableWidgetItem* mypItem = tblAnimals-&gt;item(tblAnimals-&gt;currentRow(),1);
<a name="l00992"></a>00992   <span class="keywordflow">if</span> (mypItem)
<a name="l00993"></a>00993   {
<a name="l00994"></a>00994     QString myGuid = mypItem-&gt;data(Qt::UserRole).toString();
<a name="l00995"></a>00995       <span class="comment">// QString myGuid = tblAnimals-&gt;item(tblAnimals-&gt;currentRow(),1)-&gt;data(Qt::UserRole).toString();</span>
<a name="l00996"></a>00996     <span class="keywordtype">bool</span> myStateFlag = tblAnimals-&gt;item(tblAnimals-&gt;currentRow(),0)-&gt;checkState();
<a name="l00997"></a>00997     QPair&lt;bool,QString&gt; myPair = <a class="code" href="classLaMainForm.html#d6e0150e0845d22562f0c290babf94a8">mAnimalsMap</a>[myGuid];
<a name="l00998"></a>00998     myPair.first = myStateFlag;
<a name="l00999"></a>00999     QComboBox * mypCombo=<span class="keyword">dynamic_cast&lt;</span>QComboBox *<span class="keyword">&gt;</span>(tblAnimals-&gt;cellWidget(tblAnimals-&gt;currentRow(),2));
<a name="l01000"></a>01000     myPair.second = mypCombo-&gt;itemData(mypCombo-&gt;currentIndex(),Qt::UserRole).toString();
<a name="l01001"></a>01001     <a class="code" href="classLaMainForm.html#d6e0150e0845d22562f0c290babf94a8">mAnimalsMap</a>[myGuid] = myPair;
<a name="l01002"></a>01002       <span class="comment">//debug only - comment out later</span>
<a name="l01003"></a>01003       <span class="comment">//printCropsAndAnimals();</span>
<a name="l01004"></a>01004   }
<a name="l01005"></a>01005 }
<a name="l01006"></a>01006 
<a name="l01007"></a><a class="code" href="classLaMainForm.html#c471b87b9dcd56d6d5180c74206bec73">01007</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#c471b87b9dcd56d6d5180c74206bec73">LaMainForm::cropCellClicked</a>(<span class="keywordtype">int</span> theRow, <span class="keywordtype">int</span> theColumn)
<a name="l01008"></a>01008 {
<a name="l01009"></a>01009     QTableWidgetItem* mypItem = tblCrops-&gt;item(tblCrops-&gt;currentRow(),1);
<a name="l01010"></a>01010   <span class="keywordflow">if</span> (mypItem)
<a name="l01011"></a>01011   {
<a name="l01012"></a>01012     QString myGuid = mypItem-&gt;data(Qt::UserRole).toString();
<a name="l01013"></a>01013       <span class="comment">//get all crops, then get the crop for this cell if it exists</span>
<a name="l01014"></a>01014     QMap&lt;QString,LaCrop&gt; myCropsMap = <a class="code" href="classLaUtils.html#11f60f81b93a26a0c14d5812a68e6b16">LaUtils::getAvailableCrops</a>();
<a name="l01015"></a>01015     <a class="code" href="classLaCrop.html">LaCrop</a> myCrop = myCropsMap[myGuid];
<a name="l01016"></a>01016     textBrowserCropDefinition-&gt;setHtml(myCrop.<a class="code" href="classLaCrop.html#2960c8c22c90719f6ebb965894d0a181">toHtml</a>());
<a name="l01017"></a>01017     QComboBox * mypCombo=<span class="keyword">dynamic_cast&lt;</span>QComboBox *<span class="keyword">&gt;</span>(tblCrops-&gt;cellWidget(tblCrops-&gt;currentRow(),2));
<a name="l01018"></a>01018     myGuid = mypCombo-&gt;itemData(mypCombo-&gt;currentIndex(),Qt::UserRole).toString();
<a name="l01019"></a>01019       <span class="comment">//get all crops parameters, then get the crop parameter for this cell if it exists</span>
<a name="l01020"></a>01020     <a class="code" href="classLaUtils.html#9ac69a8e1a61029ce5cfbd5985930ec0">LaUtils::CropParameterMap</a> myCropParametersMap;
<a name="l01021"></a>01021     myCropParametersMap = <a class="code" href="classLaUtils.html#d50cf3269efc4c7298768ce78b56c610">LaUtils::getAvailableCropParameters</a>();
<a name="l01022"></a>01022     <a class="code" href="classLaCropParameter.html">LaCropParameter</a> myCropParameter = myCropParametersMap[myGuid];
<a name="l01023"></a>01023     lblCropPix-&gt;setPixmap(myCrop.<a class="code" href="classLaCrop.html#3d0828f6c37ee125bba0b38cc410a7f9">imageFile</a>());
<a name="l01024"></a>01024     <a class="code" href="classLaMainForm.html#8e0c243ee7f8f01db73d7577f79bc55d">showCropDefinitionReport</a>(myCrop,myCropParameter);
<a name="l01025"></a>01025   }
<a name="l01026"></a>01026   <a class="code" href="classLaMainForm.html#e849f794758604dc070defcfb35bd42c">loadCrops</a>();
<a name="l01027"></a>01027 }
<a name="l01028"></a>01028 
<a name="l01029"></a>01029   <span class="comment">// Belloq: What a fitting end to your life's pursuits. You're about to become</span>
<a name="l01030"></a>01030   <span class="comment">//         a permanent addition to this archaeological find. Who knows? In a</span>
<a name="l01031"></a>01031   <span class="comment">//         thousand years, even you may be worth something.</span>
<a name="l01032"></a>01032 
<a name="l01033"></a><a class="code" href="classLaMainForm.html#cc174496fa1b47dbd13440a2340a37bd">01033</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#cc174496fa1b47dbd13440a2340a37bd">LaMainForm::cropCellChanged</a>(<span class="keywordtype">int</span> theRow, <span class="keywordtype">int</span> theColumn)
<a name="l01034"></a>01034 {
<a name="l01035"></a>01035   QTableWidgetItem* mypItem = tblCrops-&gt;item(tblCrops-&gt;currentRow(),1);
<a name="l01036"></a>01036   <span class="keywordflow">if</span> (mypItem)
<a name="l01037"></a>01037   {
<a name="l01038"></a>01038     QString myGuid = mypItem-&gt;data(Qt::UserRole).toString();
<a name="l01039"></a>01039     <span class="keywordtype">bool</span> myStateFlag = tblCrops-&gt;item(tblCrops-&gt;currentRow(),0)-&gt;checkState();
<a name="l01040"></a>01040     QPair&lt;bool,QString&gt; myPair = <a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>[myGuid];
<a name="l01041"></a>01041     myPair.first = myStateFlag;
<a name="l01042"></a>01042     QComboBox * mypCombo=<span class="keyword">dynamic_cast&lt;</span>QComboBox *<span class="keyword">&gt;</span>(tblCrops-&gt;cellWidget(tblCrops-&gt;currentRow(),2));
<a name="l01043"></a>01043     myPair.second = mypCombo-&gt;itemData(mypCombo-&gt;currentIndex(),Qt::UserRole).toString();
<a name="l01044"></a>01044     <a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>[myGuid] = myPair;
<a name="l01045"></a>01045   }
<a name="l01046"></a>01046 }
<a name="l01047"></a>01047 
<a name="l01048"></a><a class="code" href="classLaMainForm.html#86c1893d0cae2465b45725594bfe5a30">01048</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#86c1893d0cae2465b45725594bfe5a30">LaMainForm::on_pushButtonRun_clicked</a>()
<a name="l01049"></a>01049 {
<a name="l01050"></a>01050   <span class="keywordflow">if</span> (labelCropCheck-&gt;text() != <span class="stringliteral">"100\%"</span> or labelAnimalCheck-&gt;text() != <span class="stringliteral">"100\%"</span>)
<a name="l01051"></a>01051     {
<a name="l01052"></a>01052       tbReport-&gt;setText(<span class="stringliteral">"Check that Animals and Crops are both at 100%\n"</span>);
<a name="l01053"></a>01053       tbReport-&gt;append(<span class="stringliteral">"I am NOT going to do anything until you do!"</span>);
<a name="l01054"></a>01054       <span class="keywordflow">return</span>;
<a name="l01055"></a>01055     }
<a name="l01056"></a>01056 
<a name="l01057"></a>01057     <span class="comment">// show the user that the computer is thinking</span>
<a name="l01058"></a>01058   progressBarCalcs-&gt;reset();
<a name="l01059"></a>01059   progressBarCalcs-&gt;setRange(0,9);
<a name="l01060"></a>01060 
<a name="l01061"></a>01061   <a class="code" href="classLaModel.html">LaModel</a> myModel;
<a name="l01062"></a>01062   connect(&amp;myModel, SIGNAL(message( QString )),
<a name="l01063"></a>01063              <span class="keyword">this</span>, SLOT(<a class="code" href="classLaMainForm.html#acbb34fde5ae5de769a5f49cf49237fa">logMessage</a>( QString )));
<a name="l01064"></a>01064 
<a name="l01065"></a>01065   progressBarCalcs-&gt;setValue(1);
<a name="l01066"></a>01066     <span class="comment">// Get a list of the selected animals</span>
<a name="l01067"></a>01067   QMap&lt;QString,QString&gt; mySelectedAnimalsMap;
<a name="l01068"></a>01068     <span class="comment">//          &lt;animal guid &lt;enabled, animalparamters guid&gt;&gt;</span>
<a name="l01069"></a>01069   QMapIterator&lt;QString, QPair&lt;bool, QString&gt; &gt; myAnimalIterator(<a class="code" href="classLaMainForm.html#d6e0150e0845d22562f0c290babf94a8">mAnimalsMap</a>);
<a name="l01070"></a>01070   <span class="keywordflow">while</span> (myAnimalIterator.hasNext())
<a name="l01071"></a>01071   {
<a name="l01072"></a>01072     myAnimalIterator.next();
<a name="l01073"></a>01073     QPair&lt;bool,QString&gt; myPair = myAnimalIterator.value();
<a name="l01074"></a>01074     QString myAnimalGuid = myAnimalIterator.key();
<a name="l01075"></a>01075     QString myAnimalParameterGuid = myPair.second;
<a name="l01076"></a>01076     <span class="keywordtype">bool</span> mySelectedFlag = myPair.first;
<a name="l01077"></a>01077     <span class="keywordflow">if</span> (mySelectedFlag)
<a name="l01078"></a>01078     {
<a name="l01079"></a>01079       mySelectedAnimalsMap.insert(myAnimalGuid,myAnimalParameterGuid);
<a name="l01080"></a>01080         <span class="comment">//qDebug("Added &lt;" + myAnimalGuid.toLocal8Bit() + " , " + myAnimalParameterGuid.toLocal8Bit() + " &gt;");</span>
<a name="l01081"></a>01081     }
<a name="l01082"></a>01082   }
<a name="l01083"></a>01083 
<a name="l01084"></a>01084     <span class="comment">// Get a list of the selected crops</span>
<a name="l01085"></a>01085   QMap&lt;QString,QString&gt; mySelectedCropsMap;
<a name="l01086"></a>01086     <span class="comment">// &lt;crop guid &lt;enabled, cropparamters guid&gt;&gt;</span>
<a name="l01087"></a>01087   QMapIterator&lt;QString, QPair&lt;bool, QString&gt; &gt; myCropIterator(<a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>);
<a name="l01088"></a>01088   <span class="keywordflow">while</span> (myCropIterator.hasNext())
<a name="l01089"></a>01089   {
<a name="l01090"></a>01090     myCropIterator.next();
<a name="l01091"></a>01091     QPair&lt;bool,QString&gt; myPair = myCropIterator.value();
<a name="l01092"></a>01092     QString myCropGuid = myCropIterator.key();
<a name="l01093"></a>01093     QString myCropParameterGuid = myPair.second;
<a name="l01094"></a>01094     <span class="keywordtype">bool</span> mySelectedFlag = myPair.first;
<a name="l01095"></a>01095     <span class="keywordflow">if</span> (mySelectedFlag)
<a name="l01096"></a>01096     {
<a name="l01097"></a>01097       mySelectedCropsMap.insert(myCropGuid,myCropParameterGuid);
<a name="l01098"></a>01098         <span class="comment">//qDebug("Added &lt;" + myCropGuid.toLocal8Bit() + " , " + myCropParameterGuid.toLocal8Bit() + " &gt;");</span>
<a name="l01099"></a>01099     }
<a name="l01100"></a>01100   }
<a name="l01101"></a>01101   myModel.<a class="code" href="classLaModel.html#3fb9c4ca069ae6bf174ee32716be4f3e">setAnimals</a>(mySelectedAnimalsMap);
<a name="l01102"></a>01102   myModel.<a class="code" href="classLaModel.html#3e950192a55803924447f61b7dc46454">setCrops</a>(mySelectedCropsMap);
<a name="l01103"></a>01103   myModel.<a class="code" href="classLaModel.html#ec8302dc43a3e116a71102ce472a349d">setName</a>(lineEditSiteName-&gt;text());
<a name="l01104"></a>01104   myModel.<a class="code" href="classLaModel.html#0df5246fe38351aee25b2e1bdcb688bb">setPopulation</a>(sbPopulation-&gt;value());
<a name="l01105"></a>01105   myModel.<a class="code" href="classLaModel.html#454e3d008c0a77c30308ae488040ffa7">setPeriod</a>(lineEditPeriod-&gt;text());
<a name="l01106"></a>01106   myModel.<a class="code" href="classLaModel.html#8afd3dedeb93cda39f32844bd09270e2">setEasting</a>(lineEditEasting-&gt;text().toInt());
<a name="l01107"></a>01107   myModel.<a class="code" href="classLaModel.html#f742cc7a4e7591118898cfd223d41bc5">setNorthing</a>(lineEditNorthing-&gt;text().toInt());
<a name="l01108"></a>01108   myModel.<a class="code" href="classLaModel.html#3c7d7805d6578fb1214de7e3674bc660">setEuclideanDistance</a>(radioButtonEuclidean-&gt;isChecked());
<a name="l01109"></a>01109   myModel.<a class="code" href="classLaModel.html#401d2e8d3f01ceb5ff888d88e384684f">setWalkingTime</a>(radioButtonWalkingTime-&gt;isChecked());
<a name="l01110"></a>01110   myModel.<a class="code" href="classLaModel.html#62a4c6f93819b550d794a130722fe22a">setPathDistance</a>(radioButtonPathDistance-&gt;isChecked());
<a name="l01111"></a>01111   myModel.<a class="code" href="classLaModel.html#548b3fc043af8279bca2d50135224e3e">setPrecision</a>(sbModelPrecision-&gt;value());
<a name="l01112"></a>01112   myModel.<a class="code" href="classLaModel.html#ef1f55740dd5c8990fd0652527757d82">setDietPercent</a>(sliderDiet-&gt;value());
<a name="l01113"></a>01113   myModel.<a class="code" href="classLaModel.html#4a7fd16108be2ea4763c5cc25459a67f">setCropPercent</a>(sliderCrop-&gt;value());
<a name="l01114"></a>01114   myModel.<a class="code" href="classLaModel.html#d357afcd0c2ce4248132e5d1329a635b">setMeatPercent</a>(sliderMeat-&gt;value());
<a name="l01115"></a>01115   myModel.<a class="code" href="classLaModel.html#54b2d5d6cbd3b15565ef409b8fb3a832">setCaloriesPerPersonDaily</a>(sbDailyCalories-&gt;value());
<a name="l01116"></a>01116   myModel.<a class="code" href="classLaModel.html#88f82368ffc9be6afea709dee7ee715e">setDairyUtilisation</a>(sbDairyUtilisation-&gt;value());
<a name="l01117"></a>01117 
<a name="l01118"></a>01118   <span class="comment">// the following adjusts the Value value for use with hectares</span>
<a name="l01119"></a>01119   <span class="comment">// which is the only output that is used.</span>
<a name="l01120"></a>01120   QString mySelectedAreaUnit = QString(cbAreaUnits-&gt;currentText());
<a name="l01121"></a>01121   <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee47">AreaUnits</a> myAreaUnits = (mySelectedAreaUnit == <span class="stringliteral">"Dunum"</span>) ? <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee4710d869fda8ef9b3852491ed49722a677">Dunum</a>:<a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee476bf9786325e8633eb9e90667c85b339d">Hectare</a>;
<a name="l01122"></a>01122   <span class="keywordtype">int</span> myValue = sbCommonRasterValue-&gt;value();
<a name="l01123"></a>01123   myModel.<a class="code" href="classLaModel.html#da1b51b4c42d015dcffa831cee047f64">setCommonLandAreaUnits</a>(myAreaUnits);
<a name="l01124"></a>01124   myModel.<a class="code" href="classLaModel.html#a74a5a9cb35abb0b28b44794b1285277">setCommonLandValue</a>(myValue, myAreaUnits);
<a name="l01125"></a>01125   
<a name="l01126"></a>01126   myModel.<a class="code" href="classLaModel.html#3716d84e3fd60739f6461e52c046988c">setBaseOnPlants</a>(cboxBaseOnPlants-&gt;isChecked());
<a name="l01127"></a>01127   myModel.<a class="code" href="classLaModel.html#b9907f392b099c88de7ea10eaa22c844">setIncludeDairy</a>(cboxIncludeDairy-&gt;isChecked());
<a name="l01128"></a>01128   myModel.<a class="code" href="classLaModel.html#f4b301f0647720b442af02641ee2f190">setLimitDairy</a>(cboxIncludeDairy-&gt;isChecked());
<a name="l01129"></a>01129   myModel.<a class="code" href="classLaModel.html#e6f84f9a173cd23112d3c716c5672309">setLimitDairyPercent</a>(sbLimitDairyPercent-&gt;value());
<a name="l01130"></a>01130   myModel.<a class="code" href="classLaModel.html#88f82368ffc9be6afea709dee7ee715e">setDairyUtilisation</a>(sbDairyUtilisation-&gt;value());
<a name="l01131"></a>01131   myModel.<a class="code" href="classLaModel.html#a74a5a9cb35abb0b28b44794b1285277">setCommonLandValue</a>(sbCommonRasterValue-&gt;value(), myAreaUnits);
<a name="l01132"></a>01132 
<a name="l01133"></a>01133 
<a name="l01134"></a>01134 
<a name="l01135"></a>01135   tbReport-&gt;setHtml(myModel.<a class="code" href="classLaModel.html#e4d9b8377d7b2becccf6233c5d9090ac">toHtml</a>());
<a name="l01136"></a>01136   progressBarCalcs-&gt;setValue(2);
<a name="l01137"></a>01137 
<a name="l01138"></a>01138   myModel.<a class="code" href="classLaModel.html#e9867f7eb061ea3e6753f1769936d60a">DoCalculations</a>();
<a name="l01139"></a>01139   progressBarCalcs-&gt;setValue(3);
<a name="l01140"></a>01140 
<a name="l01141"></a>01141   tbReport-&gt;append(myModel.<a class="code" href="classLaModel.html#80e3dab60470a6d264c22cc8c4fa30fd">toHtmlCalorieCropTargets</a>());
<a name="l01142"></a>01142   progressBarCalcs-&gt;setValue(4);
<a name="l01143"></a>01143 
<a name="l01144"></a>01144   tbReport-&gt;append(myModel.<a class="code" href="classLaModel.html#aac662ecc78a295253c3979e2b96d1a4">toHtmlCalorieAnimalTargets</a>());
<a name="l01145"></a>01145   progressBarCalcs-&gt;setValue(5);
<a name="l01146"></a>01146 
<a name="l01147"></a>01147   tbReport-&gt;append(myModel.<a class="code" href="classLaModel.html#774f3e7edd4c3d7f8ead5afa1f4cdda9">toHtmlProductionCropTargets</a>());
<a name="l01148"></a>01148   progressBarCalcs-&gt;setValue(6);
<a name="l01149"></a>01149 
<a name="l01150"></a>01150   tbReport-&gt;append(myModel.<a class="code" href="classLaModel.html#c969367346ed70d1a49d029d86ae4c81">toHtmlProductionAnimalTargets</a>());
<a name="l01151"></a>01151   progressBarCalcs-&gt;setValue(7);
<a name="l01152"></a>01152 
<a name="l01153"></a>01153   tbReport-&gt;append(myModel.<a class="code" href="classLaModel.html#642659ce7818ab6b66aff8396026906d">toHtmlAreaCropTargets</a>());
<a name="l01154"></a>01154   progressBarCalcs-&gt;setValue(8);
<a name="l01155"></a>01155 
<a name="l01156"></a>01156   tbReport-&gt;append(myModel.<a class="code" href="classLaModel.html#cccc514f51427f5f9f8dd2d7bb7e1a5b">toHtmlAreaAnimalTargets</a>());
<a name="l01157"></a>01157   progressBarCalcs-&gt;setValue(9);
<a name="l01158"></a>01158 
<a name="l01159"></a>01159 
<a name="l01160"></a>01160 
<a name="l01161"></a>01161   QMap&lt;QString, int&gt; myAnimalTargetsMap = myModel.<a class="code" href="classLaModel.html#a4cbf95c85fd772771299a8e1dcc6d15">getAreaTargetsAnimalsMap</a>();
<a name="l01162"></a>01162   QMap&lt;QString, int&gt; myCropsTargetsMap = myModel.<a class="code" href="classLaModel.html#38d9549657646c5d724005a840376ac0">getAreaTargetsCropsMap</a>();
<a name="l01163"></a>01163 
<a name="l01164"></a>01164   QString myDEM = cboDEM-&gt;currentText();
<a name="l01165"></a>01165   QString myMapset = cboMapSet-&gt;currentText();
<a name="l01166"></a>01166   QString myCommonCropRaster = cboCommonCropRaster-&gt;currentText();
<a name="l01167"></a>01167   QString myCommonGrazingRaster = cboCommonGrazingRaster-&gt;currentText();
<a name="l01168"></a>01168 
<a name="l01169"></a>01169   QPair &lt;QString, QString&gt; myDEMandMapset;
<a name="l01170"></a>01170   myDEMandMapset.first = myDEM;
<a name="l01171"></a>01171   myDEMandMapset.second = myMapset;
<a name="l01172"></a>01172   QPair &lt;QString, QString&gt; myCropAndGrazingRasters;
<a name="l01173"></a>01173   myCropAndGrazingRasters.first = myCommonCropRaster;
<a name="l01174"></a>01174   myCropAndGrazingRasters.second = myCommonGrazingRaster;
<a name="l01175"></a>01175 
<a name="l01176"></a>01176   <a class="code" href="la_8h.html#4497c4505b8cc631b327a6ebc57081cc">LaRasterInfo</a> myRasterInfo;
<a name="l01177"></a>01177   myRasterInfo.first = myDEMandMapset;
<a name="l01178"></a>01178   myRasterInfo.second = myCropAndGrazingRasters;
<a name="l01179"></a>01179 
<a name="l01180"></a>01180   QPair &lt;int, int&gt; myCoordinates;
<a name="l01181"></a>01181     QString myEasting = lineEditEasting-&gt;text();
<a name="l01182"></a>01182     QString myNorthing = lineEditNorthing-&gt;text();
<a name="l01183"></a>01183     myCoordinates.first = myEasting.toInt();
<a name="l01184"></a>01184     myCoordinates.second = myNorthing.toInt();
<a name="l01185"></a>01185 
<a name="l01186"></a>01186   QPair&lt;QMap&lt;QString, int&gt;, QMap&lt;QString, int&gt; &gt; myPairOfAreaTargetMaps;
<a name="l01187"></a>01187     myPairOfAreaTargetMaps.first=myAnimalTargetsMap;
<a name="l01188"></a>01188     myPairOfAreaTargetMaps.second=myCropsTargetsMap;
<a name="l01189"></a>01189 
<a name="l01190"></a>01190   <a class="code" href="classLaGrassProcess.html">LaGrassProcess</a> myGrassProcess(myRasterInfo, myCoordinates, myPairOfAreaTargetMaps);
<a name="l01191"></a>01191 
<a name="l01192"></a>01192   myGrassProcess.exec();
<a name="l01193"></a>01193 
<a name="l01194"></a>01194 }
<a name="l01195"></a>01195 
<a name="l01196"></a><a class="code" href="classLaMainForm.html#7fb6d922588be5d48c3bda9dd31cdbc3">01196</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#7fb6d922588be5d48c3bda9dd31cdbc3">LaMainForm::debugChecks</a>()
<a name="l01197"></a>01197 {
<a name="l01198"></a>01198     <span class="comment">// iterate through crops and display the calorie, production and area targets</span>
<a name="l01199"></a>01199 
<a name="l01200"></a>01200     <span class="comment">// iterate through animals and display the calorie, production and area targets</span>
<a name="l01201"></a>01201 }
<a name="l01202"></a>01202 
<a name="l01203"></a><a class="code" href="classLaMainForm.html#ddceb9d758bad8a63a0c9fe796f372b0">01203</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#ddceb9d758bad8a63a0c9fe796f372b0">LaMainForm::on_pushButtonLoad_clicked</a>()
<a name="l01204"></a>01204 {
<a name="l01205"></a>01205     <span class="comment">//  implement me!</span>
<a name="l01206"></a>01206     <span class="comment">//  seriously... please implement me!</span>
<a name="l01207"></a>01207 }
<a name="l01208"></a>01208 
<a name="l01209"></a><a class="code" href="classLaMainForm.html#89720add4c083a88e3d0ee33874c2939">01209</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#89720add4c083a88e3d0ee33874c2939">LaMainForm::on_pushButtonSave_clicked</a>()
<a name="l01210"></a>01210 {
<a name="l01211"></a>01211     <span class="comment">// Populate the model with all the form data</span>
<a name="l01212"></a>01212   <a class="code" href="classLaModel.html">LaModel</a> myModel;
<a name="l01213"></a>01213 
<a name="l01214"></a>01214   <span class="comment">//myModel.setAnimals(mySelectedAnimalsMap);</span>
<a name="l01215"></a>01215   <span class="comment">//myModel.setCrops(mySelectedCropsMap);</span>
<a name="l01216"></a>01216   myModel.<a class="code" href="classLaModel.html#ec8302dc43a3e116a71102ce472a349d">setName</a>(lineEditSiteName-&gt;text());
<a name="l01217"></a>01217   myModel.<a class="code" href="classLaModel.html#0df5246fe38351aee25b2e1bdcb688bb">setPopulation</a>(sbPopulation-&gt;value());
<a name="l01218"></a>01218   myModel.<a class="code" href="classLaModel.html#454e3d008c0a77c30308ae488040ffa7">setPeriod</a>(lineEditPeriod-&gt;text());
<a name="l01219"></a>01219   myModel.<a class="code" href="classLaModel.html#8afd3dedeb93cda39f32844bd09270e2">setEasting</a>(lineEditEasting-&gt;text().toInt());
<a name="l01220"></a>01220   myModel.<a class="code" href="classLaModel.html#f742cc7a4e7591118898cfd223d41bc5">setNorthing</a>(lineEditNorthing-&gt;text().toInt());
<a name="l01221"></a>01221   myModel.<a class="code" href="classLaModel.html#3c7d7805d6578fb1214de7e3674bc660">setEuclideanDistance</a>(radioButtonEuclidean-&gt;isChecked());
<a name="l01222"></a>01222   myModel.<a class="code" href="classLaModel.html#401d2e8d3f01ceb5ff888d88e384684f">setWalkingTime</a>(radioButtonWalkingTime-&gt;isChecked());
<a name="l01223"></a>01223   myModel.<a class="code" href="classLaModel.html#62a4c6f93819b550d794a130722fe22a">setPathDistance</a>(radioButtonPathDistance-&gt;isChecked());
<a name="l01224"></a>01224   myModel.<a class="code" href="classLaModel.html#548b3fc043af8279bca2d50135224e3e">setPrecision</a>(sbModelPrecision-&gt;value());
<a name="l01225"></a>01225   myModel.<a class="code" href="classLaModel.html#ef1f55740dd5c8990fd0652527757d82">setDietPercent</a>(sliderDiet-&gt;value());
<a name="l01226"></a>01226   myModel.<a class="code" href="classLaModel.html#4a7fd16108be2ea4763c5cc25459a67f">setCropPercent</a>(sliderCrop-&gt;value());
<a name="l01227"></a>01227   myModel.<a class="code" href="classLaModel.html#d357afcd0c2ce4248132e5d1329a635b">setMeatPercent</a>(sliderMeat-&gt;value());
<a name="l01228"></a>01228   myModel.<a class="code" href="classLaModel.html#54b2d5d6cbd3b15565ef409b8fb3a832">setCaloriesPerPersonDaily</a>(sbDailyCalories-&gt;value());
<a name="l01229"></a>01229   myModel.<a class="code" href="classLaModel.html#88f82368ffc9be6afea709dee7ee715e">setDairyUtilisation</a>(sbDairyUtilisation-&gt;value());
<a name="l01230"></a>01230 
<a name="l01231"></a>01231   <span class="comment">// the following adjusts the Value value for use with hectares</span>
<a name="l01232"></a>01232   <span class="comment">// which is the only output that is used.</span>
<a name="l01233"></a>01233   QString mySelectedAreaUnit = QString(cbAreaUnits-&gt;currentText());
<a name="l01234"></a>01234   <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee47">AreaUnits</a> myAreaUnits = (mySelectedAreaUnit == <span class="stringliteral">"Dunum"</span>) ? <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee4710d869fda8ef9b3852491ed49722a677">Dunum</a>:<a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee476bf9786325e8633eb9e90667c85b339d">Hectare</a>;
<a name="l01235"></a>01235   <span class="keywordtype">int</span> myValue = sbCommonRasterValue-&gt;value();
<a name="l01236"></a>01236   myModel.<a class="code" href="classLaModel.html#da1b51b4c42d015dcffa831cee047f64">setCommonLandAreaUnits</a>(myAreaUnits);
<a name="l01237"></a>01237   myModel.<a class="code" href="classLaModel.html#a74a5a9cb35abb0b28b44794b1285277">setCommonLandValue</a>(myValue, myAreaUnits);
<a name="l01238"></a>01238   
<a name="l01239"></a>01239   myModel.<a class="code" href="classLaModel.html#3716d84e3fd60739f6461e52c046988c">setBaseOnPlants</a>(cboxBaseOnPlants-&gt;isChecked());
<a name="l01240"></a>01240   myModel.<a class="code" href="classLaModel.html#b9907f392b099c88de7ea10eaa22c844">setIncludeDairy</a>(cboxIncludeDairy-&gt;isChecked());
<a name="l01241"></a>01241   myModel.<a class="code" href="classLaModel.html#f4b301f0647720b442af02641ee2f190">setLimitDairy</a>(cboxIncludeDairy-&gt;isChecked());
<a name="l01242"></a>01242   myModel.<a class="code" href="classLaModel.html#e6f84f9a173cd23112d3c716c5672309">setLimitDairyPercent</a>(sbLimitDairyPercent-&gt;value());
<a name="l01243"></a>01243   myModel.<a class="code" href="classLaModel.html#88f82368ffc9be6afea709dee7ee715e">setDairyUtilisation</a>(sbDairyUtilisation-&gt;value());
<a name="l01244"></a>01244   myModel.<a class="code" href="classLaModel.html#a74a5a9cb35abb0b28b44794b1285277">setCommonLandValue</a>(sbCommonRasterValue-&gt;value(), myAreaUnits);
<a name="l01245"></a>01245 
<a name="l01246"></a>01246 
<a name="l01247"></a>01247   myModel.<a class="code" href="classLaModel.html#ec8302dc43a3e116a71102ce472a349d">setName</a>(lineEditSiteName-&gt;text());
<a name="l01248"></a>01248   myModel.<a class="code" href="classLaModel.html#0df5246fe38351aee25b2e1bdcb688bb">setPopulation</a>(sbPopulation-&gt;value());
<a name="l01249"></a>01249   myModel.<a class="code" href="classLaModel.html#454e3d008c0a77c30308ae488040ffa7">setPeriod</a>(lineEditPeriod-&gt;text());
<a name="l01250"></a>01250     <span class="comment">//myModel.setProjection(cbProjection-&gt;currentIndex());</span>
<a name="l01251"></a>01251   myModel.<a class="code" href="classLaModel.html#8afd3dedeb93cda39f32844bd09270e2">setEasting</a>(lineEditEasting-&gt;text().toInt());
<a name="l01252"></a>01252   myModel.<a class="code" href="classLaModel.html#f742cc7a4e7591118898cfd223d41bc5">setNorthing</a>(lineEditNorthing-&gt;text().toInt());
<a name="l01253"></a>01253   myModel.<a class="code" href="classLaModel.html#3c7d7805d6578fb1214de7e3674bc660">setEuclideanDistance</a>(radioButtonEuclidean-&gt;isChecked());
<a name="l01254"></a>01254   myModel.<a class="code" href="classLaModel.html#401d2e8d3f01ceb5ff888d88e384684f">setWalkingTime</a>(radioButtonWalkingTime-&gt;isChecked());
<a name="l01255"></a>01255   myModel.<a class="code" href="classLaModel.html#62a4c6f93819b550d794a130722fe22a">setPathDistance</a>(radioButtonPathDistance-&gt;isChecked());
<a name="l01256"></a>01256   myModel.<a class="code" href="classLaModel.html#548b3fc043af8279bca2d50135224e3e">setPrecision</a>(sbModelPrecision-&gt;value());
<a name="l01257"></a>01257 
<a name="l01258"></a>01258   
<a name="l01259"></a>01259   myModel.<a class="code" href="classLaSerialisable.html#0c4a1bad88e39910ea90b38a5f7494f8">toXmlFile</a>( <a class="code" href="classLaUtils.html#6e7674d98df76340d579376f3c8cfbd7">LaUtils::getModelOutputDir</a>() +
<a name="l01260"></a>01260       QDir::separator() + myModel.<a class="code" href="classLaGuid.html#38e7b78e2ef37526ffb1bad6af4cf745">guid</a>() + <span class="stringliteral">".xml"</span>);
<a name="l01261"></a>01261   <a class="code" href="classLaMainForm.html#fa256126592a486ac3a4575e12fb18e7">writeSettings</a>();
<a name="l01262"></a>01262 }
<a name="l01263"></a>01263 
<a name="l01264"></a><a class="code" href="classLaMainForm.html#d15d0c76acf846c9a41783b268dca325">01264</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#d15d0c76acf846c9a41783b268dca325">LaMainForm::writeResults</a>(QString theText)
<a name="l01265"></a>01265 {
<a name="l01266"></a>01266   tbReport-&gt;append(theText);
<a name="l01267"></a>01267 }
<a name="l01268"></a>01268 
<a name="l01269"></a><a class="code" href="classLaMainForm.html#545a7512bc9d14f4ebee101c93c2272c">01269</a> <span class="keywordtype">bool</span> <a class="code" href="classLaMainForm.html#545a7512bc9d14f4ebee101c93c2272c">LaMainForm::setComboToDefault</a>(QComboBox * thepCombo, QString theDefault)
<a name="l01270"></a>01270 {
<a name="l01271"></a>01271   <span class="keywordflow">if</span> (!theDefault.isEmpty())
<a name="l01272"></a>01272   {
<a name="l01273"></a>01273       <span class="comment">//loop through list looking for a match</span>
<a name="l01274"></a>01274     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> myCounter = 0; myCounter &lt; thepCombo-&gt;count(); myCounter++ )
<a name="l01275"></a>01275     {
<a name="l01276"></a>01276       thepCombo-&gt;setCurrentIndex(myCounter);
<a name="l01277"></a>01277       <span class="keywordflow">if</span> (thepCombo-&gt;itemData(myCounter,Qt::UserRole)==theDefault)
<a name="l01278"></a>01278       {
<a name="l01279"></a>01279         <span class="keywordflow">break</span>;
<a name="l01280"></a>01280       }
<a name="l01281"></a>01281     }
<a name="l01282"></a>01282   }
<a name="l01283"></a>01283   <span class="keywordflow">else</span>
<a name="l01284"></a>01284   {
<a name="l01285"></a>01285     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01286"></a>01286   }
<a name="l01287"></a>01287   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01288"></a>01288 }
<a name="l01289"></a>01289 
<a name="l01290"></a><a class="code" href="classLaMainForm.html#076c4ef3b09f55c995169bf1d6145347">01290</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#076c4ef3b09f55c995169bf1d6145347">LaMainForm::helpItemClicked</a>(QTreeWidgetItem * thepCurrentItem, QTreeWidgetItem * thepOldItem)
<a name="l01291"></a>01291 {
<a name="l01292"></a>01292   <a class="code" href="classLaMainForm.html#d15d0c76acf846c9a41783b268dca325">writeResults</a>(<span class="stringliteral">"Item clicked in help browser: "</span> + thepCurrentItem-&gt;text(0).toLocal8Bit());
<a name="l01293"></a>01293   QFile myQFile( <span class="stringliteral">":/helpDocs/"</span> + thepCurrentItem-&gt;text(0)  + <span class="stringliteral">".html"</span> );
<a name="l01294"></a>01294   <span class="keywordflow">if</span> ( myQFile.open( QIODevice::ReadOnly ) ) {
<a name="l01295"></a>01295       <span class="comment">//now we parse the loc file, checking each line for its taxon</span>
<a name="l01296"></a>01296     QTextStream myStream( &amp;myQFile );
<a name="l01297"></a>01297     textHelp-&gt;setHtml(myStream.readAll());
<a name="l01298"></a>01298     myQFile.close();
<a name="l01299"></a>01299   }
<a name="l01300"></a>01300   <span class="keywordflow">else</span>
<a name="l01301"></a>01301   {
<a name="l01302"></a>01302     <a class="code" href="classLaMainForm.html#d15d0c76acf846c9a41783b268dca325">writeResults</a>(<span class="stringliteral">"Help resource for : "</span> + thepCurrentItem-&gt;text(0).toLocal8Bit() + <span class="stringliteral">" not found!"</span>);
<a name="l01303"></a>01303   }
<a name="l01304"></a>01304 }
<a name="l01305"></a>01305 
<a name="l01306"></a><a class="code" href="classLaMainForm.html#196c01db18626978fda5f27a26b77334">01306</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#196c01db18626978fda5f27a26b77334">LaMainForm::cropCalcClicked</a>(QListWidgetItem * thepCurrentItem, QListWidgetItem * thepOldItem)
<a name="l01307"></a>01307 {
<a name="l01308"></a>01308     <span class="comment">// zero trap to prevent seg faults</span>
<a name="l01309"></a>01309   <span class="keywordflow">if</span> (thepCurrentItem==0) {<span class="keywordflow">return</span>;}
<a name="l01310"></a>01310 
<a name="l01311"></a>01311     <span class="comment">// ensure that the crops and animals are both at 100%</span>
<a name="l01312"></a>01312   <a class="code" href="classLaModel.html">LaModel</a> myModel;
<a name="l01313"></a>01313   <span class="keywordflow">if</span> (labelCropCheck-&gt;text() != <span class="stringliteral">"100\%"</span> or labelAnimalCheck-&gt;text() != <span class="stringliteral">"100\%"</span>)
<a name="l01314"></a>01314   {
<a name="l01315"></a>01315     tbReport-&gt;setText(<span class="stringliteral">"Check that Animals and Crops are both at 100%\n"</span>);
<a name="l01316"></a>01316     tbReport-&gt;append(<span class="stringliteral">"I am NOT going to do anything until they are!"</span>);
<a name="l01317"></a>01317     <span class="keywordflow">return</span>;
<a name="l01318"></a>01318   }
<a name="l01319"></a>01319 
<a name="l01320"></a>01320   connect(&amp;myModel, SIGNAL(message( QString )),
<a name="l01321"></a>01321              <span class="keyword">this</span>, SLOT(<a class="code" href="classLaMainForm.html#acbb34fde5ae5de769a5f49cf49237fa">logMessage</a>( QString )));
<a name="l01322"></a>01322     <span class="comment">// Get a list of the selected animals</span>
<a name="l01323"></a>01323   QMap&lt;QString,QString&gt; mySelectedAnimalsMap;
<a name="l01324"></a>01324     <span class="comment">//  &lt;animal guid &lt;enabled, animalparamters guid&gt;&gt;</span>
<a name="l01325"></a>01325   QMapIterator&lt;QString, QPair&lt;bool, QString&gt; &gt; myAnimalIterator(<a class="code" href="classLaMainForm.html#d6e0150e0845d22562f0c290babf94a8">mAnimalsMap</a>);
<a name="l01326"></a>01326   <span class="keywordflow">while</span> (myAnimalIterator.hasNext())
<a name="l01327"></a>01327   {
<a name="l01328"></a>01328     myAnimalIterator.next();
<a name="l01329"></a>01329     QPair&lt;bool,QString&gt; myPair = myAnimalIterator.value();
<a name="l01330"></a>01330     QString myAnimalGuid = myAnimalIterator.key();
<a name="l01331"></a>01331     QString myAnimalParameterGuid = myPair.second;
<a name="l01332"></a>01332     <span class="keywordtype">bool</span> mySelectedFlag = myPair.first;
<a name="l01333"></a>01333     <span class="keywordflow">if</span> (mySelectedFlag)
<a name="l01334"></a>01334     {
<a name="l01335"></a>01335       mySelectedAnimalsMap.insert(myAnimalGuid,myAnimalParameterGuid);
<a name="l01336"></a>01336     }
<a name="l01337"></a>01337   }
<a name="l01338"></a>01338   myModel.<a class="code" href="classLaModel.html#3fb9c4ca069ae6bf174ee32716be4f3e">setAnimals</a>(mySelectedAnimalsMap);
<a name="l01339"></a>01339 
<a name="l01340"></a>01340     <span class="comment">// Get a list of the selected crops</span>
<a name="l01341"></a>01341   QMap&lt;QString,QString&gt; mySelectedCropsMap;
<a name="l01342"></a>01342     <span class="comment">//  &lt;crop guid &lt;enabled, cropparamters guid&gt;&gt;</span>
<a name="l01343"></a>01343   QMapIterator&lt;QString, QPair&lt;bool, QString&gt; &gt; myCropIterator(<a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>);
<a name="l01344"></a>01344   <span class="keywordflow">while</span> (myCropIterator.hasNext())
<a name="l01345"></a>01345   {
<a name="l01346"></a>01346     myCropIterator.next();
<a name="l01347"></a>01347     QPair&lt;bool,QString&gt; myPair = myCropIterator.value();
<a name="l01348"></a>01348     QString myCropGuid = myCropIterator.key();
<a name="l01349"></a>01349     QString myCropParameterGuid = myPair.second;
<a name="l01350"></a>01350     <span class="keywordtype">bool</span> mySelectedFlag = myPair.first;
<a name="l01351"></a>01351     <span class="keywordflow">if</span> (mySelectedFlag)
<a name="l01352"></a>01352     {
<a name="l01353"></a>01353       mySelectedCropsMap.insert(myCropGuid,myCropParameterGuid);
<a name="l01354"></a>01354     }
<a name="l01355"></a>01355   }
<a name="l01356"></a>01356   myModel.<a class="code" href="classLaModel.html#3e950192a55803924447f61b7dc46454">setCrops</a>(mySelectedCropsMap);
<a name="l01357"></a>01357   myModel.<a class="code" href="classLaModel.html#3fb9c4ca069ae6bf174ee32716be4f3e">setAnimals</a>(mySelectedAnimalsMap);
<a name="l01358"></a>01358   myModel.<a class="code" href="classLaModel.html#3e950192a55803924447f61b7dc46454">setCrops</a>(mySelectedCropsMap);
<a name="l01359"></a>01359   myModel.<a class="code" href="classLaModel.html#ec8302dc43a3e116a71102ce472a349d">setName</a>(lineEditSiteName-&gt;text());
<a name="l01360"></a>01360   myModel.<a class="code" href="classLaModel.html#0df5246fe38351aee25b2e1bdcb688bb">setPopulation</a>(sbPopulation-&gt;value());
<a name="l01361"></a>01361   myModel.<a class="code" href="classLaModel.html#454e3d008c0a77c30308ae488040ffa7">setPeriod</a>(lineEditPeriod-&gt;text());
<a name="l01362"></a>01362   myModel.<a class="code" href="classLaModel.html#8afd3dedeb93cda39f32844bd09270e2">setEasting</a>(lineEditEasting-&gt;text().toInt());
<a name="l01363"></a>01363   myModel.<a class="code" href="classLaModel.html#f742cc7a4e7591118898cfd223d41bc5">setNorthing</a>(lineEditNorthing-&gt;text().toInt());
<a name="l01364"></a>01364   myModel.<a class="code" href="classLaModel.html#3c7d7805d6578fb1214de7e3674bc660">setEuclideanDistance</a>(radioButtonEuclidean-&gt;isChecked());
<a name="l01365"></a>01365   myModel.<a class="code" href="classLaModel.html#401d2e8d3f01ceb5ff888d88e384684f">setWalkingTime</a>(radioButtonWalkingTime-&gt;isChecked());
<a name="l01366"></a>01366   myModel.<a class="code" href="classLaModel.html#62a4c6f93819b550d794a130722fe22a">setPathDistance</a>(radioButtonPathDistance-&gt;isChecked());
<a name="l01367"></a>01367   myModel.<a class="code" href="classLaModel.html#548b3fc043af8279bca2d50135224e3e">setPrecision</a>(sbModelPrecision-&gt;value());
<a name="l01368"></a>01368   myModel.<a class="code" href="classLaModel.html#ef1f55740dd5c8990fd0652527757d82">setDietPercent</a>(sliderDiet-&gt;value());
<a name="l01369"></a>01369   myModel.<a class="code" href="classLaModel.html#4a7fd16108be2ea4763c5cc25459a67f">setCropPercent</a>(sliderCrop-&gt;value());
<a name="l01370"></a>01370   myModel.<a class="code" href="classLaModel.html#d357afcd0c2ce4248132e5d1329a635b">setMeatPercent</a>(sliderMeat-&gt;value());
<a name="l01371"></a>01371   myModel.<a class="code" href="classLaModel.html#54b2d5d6cbd3b15565ef409b8fb3a832">setCaloriesPerPersonDaily</a>(sbDailyCalories-&gt;value());
<a name="l01372"></a>01372   myModel.<a class="code" href="classLaModel.html#88f82368ffc9be6afea709dee7ee715e">setDairyUtilisation</a>(sbDairyUtilisation-&gt;value());
<a name="l01373"></a>01373 
<a name="l01374"></a>01374   <span class="comment">// the following adjusts the Value value for use with hectares</span>
<a name="l01375"></a>01375   <span class="comment">// which is the only output that is used.</span>
<a name="l01376"></a>01376   QString mySelectedAreaUnit = QString(cbAreaUnits-&gt;currentText());
<a name="l01377"></a>01377   <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee47">AreaUnits</a> myAreaUnits = (mySelectedAreaUnit == <span class="stringliteral">"Dunum"</span>) ? <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee4710d869fda8ef9b3852491ed49722a677">Dunum</a>:<a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee476bf9786325e8633eb9e90667c85b339d">Hectare</a>;
<a name="l01378"></a>01378   <span class="keywordtype">int</span> myValue = sbCommonRasterValue-&gt;value();
<a name="l01379"></a>01379   myModel.<a class="code" href="classLaModel.html#da1b51b4c42d015dcffa831cee047f64">setCommonLandAreaUnits</a>(myAreaUnits);
<a name="l01380"></a>01380   myModel.<a class="code" href="classLaModel.html#a74a5a9cb35abb0b28b44794b1285277">setCommonLandValue</a>(myValue, myAreaUnits);
<a name="l01381"></a>01381   
<a name="l01382"></a>01382   myModel.<a class="code" href="classLaModel.html#3716d84e3fd60739f6461e52c046988c">setBaseOnPlants</a>(cboxBaseOnPlants-&gt;isChecked());
<a name="l01383"></a>01383   myModel.<a class="code" href="classLaModel.html#b9907f392b099c88de7ea10eaa22c844">setIncludeDairy</a>(cboxIncludeDairy-&gt;isChecked());
<a name="l01384"></a>01384   myModel.<a class="code" href="classLaModel.html#f4b301f0647720b442af02641ee2f190">setLimitDairy</a>(cboxIncludeDairy-&gt;isChecked());
<a name="l01385"></a>01385   myModel.<a class="code" href="classLaModel.html#e6f84f9a173cd23112d3c716c5672309">setLimitDairyPercent</a>(sbLimitDairyPercent-&gt;value());
<a name="l01386"></a>01386   myModel.<a class="code" href="classLaModel.html#88f82368ffc9be6afea709dee7ee715e">setDairyUtilisation</a>(sbDairyUtilisation-&gt;value());
<a name="l01387"></a>01387   myModel.<a class="code" href="classLaModel.html#a74a5a9cb35abb0b28b44794b1285277">setCommonLandValue</a>(sbCommonRasterValue-&gt;value(), myAreaUnits);
<a name="l01388"></a>01388 
<a name="l01389"></a>01389 
<a name="l01390"></a>01390   myModel.<a class="code" href="classLaModel.html#ec8302dc43a3e116a71102ce472a349d">setName</a>(lineEditSiteName-&gt;text());
<a name="l01391"></a>01391   myModel.<a class="code" href="classLaModel.html#0df5246fe38351aee25b2e1bdcb688bb">setPopulation</a>(sbPopulation-&gt;value());
<a name="l01392"></a>01392   myModel.<a class="code" href="classLaModel.html#454e3d008c0a77c30308ae488040ffa7">setPeriod</a>(lineEditPeriod-&gt;text());
<a name="l01393"></a>01393     <span class="comment">//myModel.setProjection(cbProjection-&gt;currentIndex());</span>
<a name="l01394"></a>01394   myModel.<a class="code" href="classLaModel.html#8afd3dedeb93cda39f32844bd09270e2">setEasting</a>(lineEditEasting-&gt;text().toInt());
<a name="l01395"></a>01395   myModel.<a class="code" href="classLaModel.html#f742cc7a4e7591118898cfd223d41bc5">setNorthing</a>(lineEditNorthing-&gt;text().toInt());
<a name="l01396"></a>01396   myModel.<a class="code" href="classLaModel.html#3c7d7805d6578fb1214de7e3674bc660">setEuclideanDistance</a>(radioButtonEuclidean-&gt;isChecked());
<a name="l01397"></a>01397   myModel.<a class="code" href="classLaModel.html#401d2e8d3f01ceb5ff888d88e384684f">setWalkingTime</a>(radioButtonWalkingTime-&gt;isChecked());
<a name="l01398"></a>01398   myModel.<a class="code" href="classLaModel.html#62a4c6f93819b550d794a130722fe22a">setPathDistance</a>(radioButtonPathDistance-&gt;isChecked());
<a name="l01399"></a>01399   myModel.<a class="code" href="classLaModel.html#548b3fc043af8279bca2d50135224e3e">setPrecision</a>(sbModelPrecision-&gt;value());
<a name="l01400"></a>01400   
<a name="l01401"></a>01401   tbReport-&gt;setHtml(myModel.<a class="code" href="classLaModel.html#e4d9b8377d7b2becccf6233c5d9090ac">toHtml</a>());
<a name="l01402"></a>01402   myModel.<a class="code" href="classLaModel.html#e9867f7eb061ea3e6753f1769936d60a">DoCalculations</a>();
<a name="l01403"></a>01403 
<a name="l01404"></a>01404   QString myGuid = thepCurrentItem-&gt;data(Qt::UserRole).toString();
<a name="l01405"></a>01405   <a class="code" href="classLaCrop.html">LaCrop</a> myCrop = <a class="code" href="classLaUtils.html#7f444ecadda6970730d87db2d166091e">LaUtils::getCrop</a>(myGuid);
<a name="l01406"></a>01406   lblCropPicCalcs-&gt;setPixmap(myCrop.<a class="code" href="classLaCrop.html#3d0828f6c37ee125bba0b38cc410a7f9">imageFile</a>());
<a name="l01407"></a>01407   QMap &lt;QString, QString&gt; myCalcsMap = myModel.<a class="code" href="classLaModel.html#a3988cbb455bd0db0cb6e50a8b5dd992">calcsCropsMap</a>();
<a name="l01408"></a>01408   textBrowserResultsCrop-&gt;setText(myCalcsMap.value(myGuid));
<a name="l01409"></a>01409 }
<a name="l01410"></a>01410 
<a name="l01411"></a><a class="code" href="classLaMainForm.html#76dc78137d056694ea36bde5652b7faf">01411</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#76dc78137d056694ea36bde5652b7faf">LaMainForm::animalCalcClicked</a>(QListWidgetItem * thepCurrentItem, QListWidgetItem * thepOldItem)
<a name="l01412"></a>01412 {
<a name="l01413"></a>01413     <span class="comment">// zero trap to prevent seg faults</span>
<a name="l01414"></a>01414   <span class="keywordflow">if</span> (thepCurrentItem==0) {<span class="keywordflow">return</span>;}
<a name="l01415"></a>01415 
<a name="l01416"></a>01416     <span class="comment">// ensure that the crops and animals are both at 100%</span>
<a name="l01417"></a>01417   <a class="code" href="classLaModel.html">LaModel</a> myModel;
<a name="l01418"></a>01418   <span class="keywordflow">if</span> (labelCropCheck-&gt;text() != <span class="stringliteral">"100\%"</span> or labelAnimalCheck-&gt;text() != <span class="stringliteral">"100\%"</span>)
<a name="l01419"></a>01419   {
<a name="l01420"></a>01420     tbReport-&gt;setText(<span class="stringliteral">"Check that Animals and Crops are both at 100%\n"</span>);
<a name="l01421"></a>01421     tbReport-&gt;append(<span class="stringliteral">"I am NOT going to do anything until they are!"</span>);
<a name="l01422"></a>01422     <span class="keywordflow">return</span>;
<a name="l01423"></a>01423   }
<a name="l01424"></a>01424 
<a name="l01425"></a>01425     <span class="comment">// show the user that the computer is thinking</span>
<a name="l01426"></a>01426     <span class="comment">//progressBarCalcs-&gt;reset();</span>
<a name="l01427"></a>01427     <span class="comment">//progressBarCalcs-&gt;setRange(0,0);</span>
<a name="l01428"></a>01428   <span class="comment">//AreaUnits myAreaUnits = (cbAreaUnits-&gt;currentText() == "Dunum") ? Dunum : Hectare;</span>
<a name="l01429"></a>01429 
<a name="l01430"></a>01430   connect(&amp;myModel, SIGNAL(message( QString )),
<a name="l01431"></a>01431              <span class="keyword">this</span>, SLOT(<a class="code" href="classLaMainForm.html#acbb34fde5ae5de769a5f49cf49237fa">logMessage</a>( QString )));
<a name="l01432"></a>01432     <span class="comment">// Get a list of the selected animals</span>
<a name="l01433"></a>01433   QMap&lt;QString,QString&gt; mySelectedAnimalsMap;
<a name="l01434"></a>01434     <span class="comment">// &lt;animal guid &lt;enabled, animalparamters guid&gt;&gt;</span>
<a name="l01435"></a>01435   QMapIterator&lt;QString, QPair&lt;bool, QString&gt; &gt; myAnimalIterator(<a class="code" href="classLaMainForm.html#d6e0150e0845d22562f0c290babf94a8">mAnimalsMap</a>);
<a name="l01436"></a>01436   <span class="keywordflow">while</span> (myAnimalIterator.hasNext())
<a name="l01437"></a>01437   {
<a name="l01438"></a>01438     myAnimalIterator.next();
<a name="l01439"></a>01439     QPair&lt;bool,QString&gt; myPair = myAnimalIterator.value();
<a name="l01440"></a>01440     QString myAnimalGuid = myAnimalIterator.key();
<a name="l01441"></a>01441     QString myAnimalParameterGuid = myPair.second;
<a name="l01442"></a>01442     <span class="keywordtype">bool</span> mySelectedFlag = myPair.first;
<a name="l01443"></a>01443     <span class="keywordflow">if</span> (mySelectedFlag)
<a name="l01444"></a>01444     {
<a name="l01445"></a>01445       mySelectedAnimalsMap.insert(myAnimalGuid,myAnimalParameterGuid);
<a name="l01446"></a>01446     }
<a name="l01447"></a>01447   }
<a name="l01448"></a>01448 
<a name="l01449"></a>01449     <span class="comment">// Get a list of the selected crops</span>
<a name="l01450"></a>01450   QMap&lt;QString,QString&gt; mySelectedCropsMap;
<a name="l01451"></a>01451   QMapIterator&lt;QString, QPair&lt;bool, QString&gt; &gt; myCropIterator(<a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>);
<a name="l01452"></a>01452   <span class="keywordflow">while</span> (myCropIterator.hasNext())
<a name="l01453"></a>01453   {
<a name="l01454"></a>01454     myCropIterator.next();
<a name="l01455"></a>01455     QPair&lt;bool,QString&gt; myPair = myCropIterator.value();
<a name="l01456"></a>01456     QString myCropGuid = myCropIterator.key();
<a name="l01457"></a>01457     QString myCropParameterGuid = myPair.second;
<a name="l01458"></a>01458     <span class="keywordtype">bool</span> mySelectedFlag = myPair.first;
<a name="l01459"></a>01459     <span class="keywordflow">if</span> (mySelectedFlag)
<a name="l01460"></a>01460     {
<a name="l01461"></a>01461       mySelectedCropsMap.insert(myCropGuid,myCropParameterGuid);
<a name="l01462"></a>01462     }
<a name="l01463"></a>01463   }
<a name="l01464"></a>01464   myModel.<a class="code" href="classLaModel.html#3fb9c4ca069ae6bf174ee32716be4f3e">setAnimals</a>(mySelectedAnimalsMap);
<a name="l01465"></a>01465   myModel.<a class="code" href="classLaModel.html#3e950192a55803924447f61b7dc46454">setCrops</a>(mySelectedCropsMap);
<a name="l01466"></a>01466   myModel.<a class="code" href="classLaModel.html#ec8302dc43a3e116a71102ce472a349d">setName</a>(lineEditSiteName-&gt;text());
<a name="l01467"></a>01467   myModel.<a class="code" href="classLaModel.html#0df5246fe38351aee25b2e1bdcb688bb">setPopulation</a>(sbPopulation-&gt;value());
<a name="l01468"></a>01468   myModel.<a class="code" href="classLaModel.html#454e3d008c0a77c30308ae488040ffa7">setPeriod</a>(lineEditPeriod-&gt;text());
<a name="l01469"></a>01469   myModel.<a class="code" href="classLaModel.html#8afd3dedeb93cda39f32844bd09270e2">setEasting</a>(lineEditEasting-&gt;text().toInt());
<a name="l01470"></a>01470   myModel.<a class="code" href="classLaModel.html#f742cc7a4e7591118898cfd223d41bc5">setNorthing</a>(lineEditNorthing-&gt;text().toInt());
<a name="l01471"></a>01471   myModel.<a class="code" href="classLaModel.html#3c7d7805d6578fb1214de7e3674bc660">setEuclideanDistance</a>(radioButtonEuclidean-&gt;isChecked());
<a name="l01472"></a>01472   myModel.<a class="code" href="classLaModel.html#401d2e8d3f01ceb5ff888d88e384684f">setWalkingTime</a>(radioButtonWalkingTime-&gt;isChecked());
<a name="l01473"></a>01473   myModel.<a class="code" href="classLaModel.html#62a4c6f93819b550d794a130722fe22a">setPathDistance</a>(radioButtonPathDistance-&gt;isChecked());
<a name="l01474"></a>01474   myModel.<a class="code" href="classLaModel.html#548b3fc043af8279bca2d50135224e3e">setPrecision</a>(sbModelPrecision-&gt;value());
<a name="l01475"></a>01475   myModel.<a class="code" href="classLaModel.html#ef1f55740dd5c8990fd0652527757d82">setDietPercent</a>(sliderDiet-&gt;value());
<a name="l01476"></a>01476   myModel.<a class="code" href="classLaModel.html#4a7fd16108be2ea4763c5cc25459a67f">setCropPercent</a>(sliderCrop-&gt;value());
<a name="l01477"></a>01477   myModel.<a class="code" href="classLaModel.html#d357afcd0c2ce4248132e5d1329a635b">setMeatPercent</a>(sliderMeat-&gt;value());
<a name="l01478"></a>01478   myModel.<a class="code" href="classLaModel.html#54b2d5d6cbd3b15565ef409b8fb3a832">setCaloriesPerPersonDaily</a>(sbDailyCalories-&gt;value());
<a name="l01479"></a>01479   myModel.<a class="code" href="classLaModel.html#88f82368ffc9be6afea709dee7ee715e">setDairyUtilisation</a>(sbDairyUtilisation-&gt;value());
<a name="l01480"></a>01480 
<a name="l01481"></a>01481   <span class="comment">// the following adjusts the Value value for use with hectares</span>
<a name="l01482"></a>01482   <span class="comment">// which is the only output that is used.</span>
<a name="l01483"></a>01483   QString mySelectedAreaUnit = QString(cbAreaUnits-&gt;currentText());
<a name="l01484"></a>01484   <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee47">AreaUnits</a> myAreaUnits = (mySelectedAreaUnit == <span class="stringliteral">"Dunum"</span>) ? <a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee4710d869fda8ef9b3852491ed49722a677">Dunum</a>:<a class="code" href="la_8h.html#d5c8cac9c62ffdb8a2223362226dee476bf9786325e8633eb9e90667c85b339d">Hectare</a>;
<a name="l01485"></a>01485   <span class="keywordtype">int</span> myValue = sbCommonRasterValue-&gt;value();
<a name="l01486"></a>01486   myModel.<a class="code" href="classLaModel.html#da1b51b4c42d015dcffa831cee047f64">setCommonLandAreaUnits</a>(myAreaUnits);
<a name="l01487"></a>01487   myModel.<a class="code" href="classLaModel.html#a74a5a9cb35abb0b28b44794b1285277">setCommonLandValue</a>(myValue, myAreaUnits);
<a name="l01488"></a>01488   
<a name="l01489"></a>01489   myModel.<a class="code" href="classLaModel.html#3716d84e3fd60739f6461e52c046988c">setBaseOnPlants</a>(cboxBaseOnPlants-&gt;isChecked());
<a name="l01490"></a>01490   myModel.<a class="code" href="classLaModel.html#b9907f392b099c88de7ea10eaa22c844">setIncludeDairy</a>(cboxIncludeDairy-&gt;isChecked());
<a name="l01491"></a>01491   myModel.<a class="code" href="classLaModel.html#f4b301f0647720b442af02641ee2f190">setLimitDairy</a>(cboxIncludeDairy-&gt;isChecked());
<a name="l01492"></a>01492   myModel.<a class="code" href="classLaModel.html#e6f84f9a173cd23112d3c716c5672309">setLimitDairyPercent</a>(sbLimitDairyPercent-&gt;value());
<a name="l01493"></a>01493   myModel.<a class="code" href="classLaModel.html#88f82368ffc9be6afea709dee7ee715e">setDairyUtilisation</a>(sbDairyUtilisation-&gt;value());
<a name="l01494"></a>01494   myModel.<a class="code" href="classLaModel.html#a74a5a9cb35abb0b28b44794b1285277">setCommonLandValue</a>(sbCommonRasterValue-&gt;value(), myAreaUnits);
<a name="l01495"></a>01495 
<a name="l01496"></a>01496 
<a name="l01497"></a>01497   myModel.<a class="code" href="classLaModel.html#ec8302dc43a3e116a71102ce472a349d">setName</a>(lineEditSiteName-&gt;text());
<a name="l01498"></a>01498   myModel.<a class="code" href="classLaModel.html#0df5246fe38351aee25b2e1bdcb688bb">setPopulation</a>(sbPopulation-&gt;value());
<a name="l01499"></a>01499   myModel.<a class="code" href="classLaModel.html#454e3d008c0a77c30308ae488040ffa7">setPeriod</a>(lineEditPeriod-&gt;text());
<a name="l01500"></a>01500     <span class="comment">//myModel.setProjection(cbProjection-&gt;currentIndex());</span>
<a name="l01501"></a>01501   myModel.<a class="code" href="classLaModel.html#8afd3dedeb93cda39f32844bd09270e2">setEasting</a>(lineEditEasting-&gt;text().toInt());
<a name="l01502"></a>01502   myModel.<a class="code" href="classLaModel.html#f742cc7a4e7591118898cfd223d41bc5">setNorthing</a>(lineEditNorthing-&gt;text().toInt());
<a name="l01503"></a>01503   myModel.<a class="code" href="classLaModel.html#3c7d7805d6578fb1214de7e3674bc660">setEuclideanDistance</a>(radioButtonEuclidean-&gt;isChecked());
<a name="l01504"></a>01504   myModel.<a class="code" href="classLaModel.html#401d2e8d3f01ceb5ff888d88e384684f">setWalkingTime</a>(radioButtonWalkingTime-&gt;isChecked());
<a name="l01505"></a>01505   myModel.<a class="code" href="classLaModel.html#62a4c6f93819b550d794a130722fe22a">setPathDistance</a>(radioButtonPathDistance-&gt;isChecked());
<a name="l01506"></a>01506   myModel.<a class="code" href="classLaModel.html#548b3fc043af8279bca2d50135224e3e">setPrecision</a>(sbModelPrecision-&gt;value());
<a name="l01507"></a>01507   
<a name="l01508"></a>01508   tbReport-&gt;setHtml(myModel.<a class="code" href="classLaModel.html#e4d9b8377d7b2becccf6233c5d9090ac">toHtml</a>());
<a name="l01509"></a>01509   myModel.<a class="code" href="classLaModel.html#e9867f7eb061ea3e6753f1769936d60a">DoCalculations</a>();
<a name="l01510"></a>01510 
<a name="l01511"></a>01511   QString myGuid = thepCurrentItem-&gt;data(Qt::UserRole).toString();
<a name="l01512"></a>01512   <a class="code" href="classLaAnimal.html">LaAnimal</a> myAnimal = <a class="code" href="classLaUtils.html#31401524c3416531ef439851cd69cd21">LaUtils::getAnimal</a>(myGuid);
<a name="l01513"></a>01513   lblAnimalPicCalcs-&gt;setPixmap(myAnimal.<a class="code" href="classLaAnimal.html#a864020562f76302ad279c569ebf96c7">imageFile</a>());
<a name="l01514"></a>01514   QMap &lt;QString, QString&gt; myCalcsMap = myModel.<a class="code" href="classLaModel.html#9244130f6d90e7b9a83f7afd455a2e41">calcsAnimalsMap</a>();
<a name="l01515"></a>01515   textBrowserResultsAnimals-&gt;setText(myCalcsMap.value(myGuid));
<a name="l01516"></a>01516   progressBarCalcs-&gt;setMaximum(100);
<a name="l01517"></a>01517 }
<a name="l01518"></a>01518 
<a name="l01519"></a><a class="code" href="classLaMainForm.html#20c9ea11c03ab3b43f318b8753a3f274">01519</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#20c9ea11c03ab3b43f318b8753a3f274">LaMainForm::printCropsAndAnimals</a>()
<a name="l01520"></a>01520 {
<a name="l01521"></a>01521   tbReport-&gt;clear();
<a name="l01522"></a>01522   QMapIterator&lt;QString, QPair&lt;bool, QString&gt; &gt; myAnimalIterator(<a class="code" href="classLaMainForm.html#d6e0150e0845d22562f0c290babf94a8">mAnimalsMap</a>);
<a name="l01523"></a>01523   <span class="keywordflow">while</span> (myAnimalIterator.hasNext())
<a name="l01524"></a>01524   {
<a name="l01525"></a>01525     myAnimalIterator.next();
<a name="l01526"></a>01526     QPair&lt;bool,QString&gt; myPair = myAnimalIterator.value();
<a name="l01527"></a>01527     QString myAnimalGuid = myAnimalIterator.key();
<a name="l01528"></a>01528     <span class="keywordtype">bool</span> mySelectedFlag = myPair.first;
<a name="l01529"></a>01529     QString myAnimalParameterGuid = myPair.second;
<a name="l01530"></a>01530     QString myText = <span class="stringliteral">"Animal &lt;"</span> + myAnimalGuid.toLocal8Bit() +
<a name="l01531"></a>01531       <span class="stringliteral">" , &lt;"</span>;
<a name="l01532"></a>01532     mySelectedFlag ? myText += <span class="stringliteral">"true,"</span> : myText += <span class="stringliteral">"false,"</span>;
<a name="l01533"></a>01533     myText +=  myAnimalParameterGuid.toLocal8Bit() ;
<a name="l01534"></a>01534     myText += <span class="stringliteral">"&gt; &gt;"</span>;
<a name="l01535"></a>01535     tbLogs-&gt;append(myText);
<a name="l01536"></a>01536   }
<a name="l01537"></a>01537 
<a name="l01538"></a>01538   QMapIterator&lt;QString, QPair&lt;bool, QString&gt; &gt; myCropIterator(<a class="code" href="classLaMainForm.html#e52967be09fab6a73defcb8a1a3e1c72">mCropsMap</a>);
<a name="l01539"></a>01539   <span class="keywordflow">while</span> (myCropIterator.hasNext())
<a name="l01540"></a>01540   {
<a name="l01541"></a>01541     myCropIterator.next();
<a name="l01542"></a>01542     QPair&lt;bool,QString&gt; myPair = myCropIterator.value();
<a name="l01543"></a>01543     QString myCropGuid = myCropIterator.key();
<a name="l01544"></a>01544     <span class="keywordtype">bool</span> mySelectedFlag = myPair.first;
<a name="l01545"></a>01545     QString myCropParameterGuid = myPair.second;
<a name="l01546"></a>01546     QString myText = <span class="stringliteral">"Crop &lt;"</span> + myCropGuid.toLocal8Bit() +
<a name="l01547"></a>01547       <span class="stringliteral">" , &lt;"</span>;
<a name="l01548"></a>01548     mySelectedFlag ? myText += <span class="stringliteral">"true,"</span> : myText += <span class="stringliteral">"false,"</span>;
<a name="l01549"></a>01549     myText +=  myCropParameterGuid.toLocal8Bit() ;
<a name="l01550"></a>01550     myText += <span class="stringliteral">"&gt; &gt;"</span>;
<a name="l01551"></a>01551     tbLogs-&gt;append(myText);
<a name="l01552"></a>01552   }
<a name="l01553"></a>01553 }
<a name="l01554"></a>01554 
<a name="l01555"></a><a class="code" href="classLaMainForm.html#acbb34fde5ae5de769a5f49cf49237fa">01555</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#acbb34fde5ae5de769a5f49cf49237fa">LaMainForm::logMessage</a>(QString theMessage)
<a name="l01556"></a>01556 {
<a name="l01557"></a>01557   tbLogs-&gt;append(theMessage);
<a name="l01558"></a>01558   tbLogs-&gt;ensureCursorVisible();
<a name="l01559"></a>01559 }
<a name="l01560"></a>01560 
<a name="l01561"></a>01561 
<a name="l01562"></a><a class="code" href="classLaMainForm.html#8e0e3226dd89f0b6d9dfcbb3c75d83ca">01562</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#8e0e3226dd89f0b6d9dfcbb3c75d83ca">LaMainForm::showAnimalDefinitionReport</a>(<a class="code" href="classLaAnimal.html">LaAnimal</a> &amp;theAnimal, <a class="code" href="classLaAnimalParameter.html">LaAnimalParameter</a> &amp;theAnimalParameter)
<a name="l01563"></a>01563 {
<a name="l01564"></a>01564   QString myHtml;
<a name="l01565"></a>01565   myHtml = <span class="stringliteral">"&lt;body&gt;"</span>;
<a name="l01566"></a>01566   myHtml += <span class="stringliteral">"&lt;table width=\"100%\"&gt;"</span>;
<a name="l01567"></a>01567   myHtml += <span class="stringliteral">"&lt;tr&gt;"</span>;
<a name="l01568"></a>01568   myHtml += <span class="stringliteral">"&lt;td&gt;"</span>;
<a name="l01569"></a>01569   myHtml += theAnimal.<a class="code" href="classLaAnimal.html#cc54e505ab043f231614e33f0a69d8b5">toHtml</a>();
<a name="l01570"></a>01570   myHtml += <span class="stringliteral">"&lt;/td&gt;"</span>;
<a name="l01571"></a>01571   myHtml += <span class="stringliteral">"&lt;td&gt;"</span>;
<a name="l01572"></a>01572   myHtml += theAnimalParameter.<a class="code" href="classLaAnimalParameter.html#1b1432c5a77a15ce847647c30656da88">toHtml</a>();
<a name="l01573"></a>01573   myHtml += <span class="stringliteral">"&lt;/td&gt;"</span>;
<a name="l01574"></a>01574   myHtml += <span class="stringliteral">"&lt;/tr&gt;"</span>;
<a name="l01575"></a>01575   myHtml += <span class="stringliteral">"&lt;/table&gt;"</span>;
<a name="l01576"></a>01576   myHtml += <span class="stringliteral">"&lt;/body&gt;"</span>;
<a name="l01577"></a>01577   textBrowserAnimalDefinition-&gt;document()-&gt;setDefaultStyleSheet(<a class="code" href="classLaUtils.html#af4241b9ca1b08b14a5aebc86649806a">LaUtils::getStandardCss</a>());
<a name="l01578"></a>01578   textBrowserAnimalDefinition-&gt;setHtml(myHtml);
<a name="l01579"></a>01579 }
<a name="l01580"></a>01580 
<a name="l01581"></a><a class="code" href="classLaMainForm.html#8e0c243ee7f8f01db73d7577f79bc55d">01581</a> <span class="keywordtype">void</span> <a class="code" href="classLaMainForm.html#8e0c243ee7f8f01db73d7577f79bc55d">LaMainForm::showCropDefinitionReport</a>(<a class="code" href="classLaCrop.html">LaCrop</a> &amp;theCrop, <a class="code" href="classLaCropParameter.html">LaCropParameter</a> &amp;theCropParameter)
<a name="l01582"></a>01582 {
<a name="l01583"></a>01583   QString myHtml;
<a name="l01584"></a>01584   myHtml = <span class="stringliteral">"&lt;body&gt;"</span>;
<a name="l01585"></a>01585   myHtml += <span class="stringliteral">"&lt;table width=\"100%\"&gt;"</span>;
<a name="l01586"></a>01586   myHtml += <span class="stringliteral">"&lt;tr&gt;"</span>;
<a name="l01587"></a>01587   myHtml += <span class="stringliteral">"&lt;td&gt;"</span>;
<a name="l01588"></a>01588   myHtml += theCrop.<a class="code" href="classLaCrop.html#2960c8c22c90719f6ebb965894d0a181">toHtml</a>();
<a name="l01589"></a>01589   myHtml += <span class="stringliteral">"&lt;/td&gt;"</span>;
<a name="l01590"></a>01590   myHtml += <span class="stringliteral">"&lt;td&gt;"</span>;
<a name="l01591"></a>01591   myHtml += theCropParameter.<a class="code" href="classLaCropParameter.html#b52169fb0bccc1185786d1dd322d074d">toHtml</a>();
<a name="l01592"></a>01592   myHtml += <span class="stringliteral">"&lt;/td&gt;"</span>;
<a name="l01593"></a>01593   myHtml += <span class="stringliteral">"&lt;/tr&gt;"</span>;
<a name="l01594"></a>01594   myHtml += <span class="stringliteral">"&lt;/table&gt;"</span>;
<a name="l01595"></a>01595   myHtml += <span class="stringliteral">"&lt;/body&gt;"</span>;
<a name="l01596"></a>01596   textBrowserCropDefinition-&gt;document()-&gt;setDefaultStyleSheet(<a class="code" href="classLaUtils.html#af4241b9ca1b08b14a5aebc86649806a">LaUtils::getStandardCss</a>());
<a name="l01597"></a>01597   textBrowserCropDefinition-&gt;setHtml(myHtml);
<a name="l01598"></a>01598 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Jan 24 19:44:57 2009 for Landuse Analyst by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
